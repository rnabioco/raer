[{"path":"https://rnabioco.github.io/raer/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 raer authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (â€œSoftwareâ€), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED â€œâ€, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://rnabioco.github.io/raer/articles/novel-sites.html","id":"novel-rna-editing-site-detection-tutorial","dir":"Articles","previous_headings":"","what":"Novel RNA editing site detection tutorial","title":"Identifying RNA editing sites using RNA and DNA sequencing data","text":"vignette demonstrate identify novel RNA editing sites using raer package. vignette public RNA-seq Whole-Genome sequencing dataset analyzed. High coverage whole-genome sequencing conducted ERR262997 along paired-end RNA-seq SRR1258218. Aligned BAM files genome fasta file preprocessed vignette. files occupy ~100 Mb space contain alignments first 1MB chromosome 4 stored BiocFileCache. Additionally use following additional annotation resources: database known SNPs, example SNPlocs.Hsapiens.dbSNP155.GRCh38 package. Due space memory constraints , vignette use BED file containing SNPs first 1Mb region chr4. TxDb.Hsapiens.UCSC.hg38.knownGene, database transcript models. Alternatively can generated .gtf file using makeTxDbFromGRanges() GenomicFeatures package. RepeatMasker annotations, can obtained AnnotationHub() hg38. space reasons annotations chr4 included text file. pileup_sites() function can accept multiple bam files, supply one RNA-seq, one whole genome sequencing. Filtering parameters pileup_sites() function can accept multiple arguments matched input bam files. Next filter keep sites variant RNA-seq, variant DNA-seq, minimum 5 reads DNA-seq. DNA-seq data reported â€œ+â€ strand, RNA-seq data reported either strand. therefore use subsetByOverlaps(..., ignore.strand = TRUE) retain sites passing DNA-seq based filters independent strand. Next filter remove multi-allelic sites. sites stored comma-separated strings ALT assay (e.g.Â G,C). Non-variant sites stored -. filter_multiallelic() remove sites multiple variants samples present summarizedExperiment object. add new column rowData() indicate variant site, calculate allele_freq assay variant allele frequencies sample. Next â€™ll remove sites simple repeat regions. add repeat information rowData() using annot_from_gr() function. Next â€™ll remove sites adjacent sites different variant types. example ->G variant located proximal C->T variant variants removed. Next, sites within 4bp known splicing events excluded. sites low-confidence due possibility mis-alignments near splicing events. Next, â€™ll annotate site known SNP remove known SNPs. using SNPlocs package can use annot_snp() function. However use annot_from_gr() function annotate using prebuilt chr4snps object. Lastly, â€™ll filter edit sites require editing frequency > 0.05 least 2 reads support editing site.","code":"fns <- download_NA12878() fns ## $bams ## [1] \"/github/home/.cache/R/raer/ERR262996_dedup_chr4_sub.bam\"            ## [2] \"/github/home/.cache/R/raer/SRR1258218_Aligned.sorted.dedup_sub.bam\" ##  ## $bai ## [1] \"/github/home/.cache/R/raer/ERR262996_dedup_chr4_sub.bam.bai\"            ## [2] \"/github/home/.cache/R/raer/SRR1258218_Aligned.sorted.dedup_sub.bam.bai\" ##  ## $fasta ## [1] \"/github/home/.cache/R/raer/5c910363ec3_hg38_chr4.fa.bgz\" ##  ## $snps ## [1] \"/github/home/.cache/R/raer/5c95cfbb0a6_chr4snps.bed.gz\" ##  ## $rmsk ## [1] \"/github/home/.cache/R/raer/5c9224a4ef2_rmsk_hg38.tsv.gz\" txdb <- TxDb.Hsapiens.UCSC.hg38.knownGene  chr4snps <- import(fns$snps)  rmskhg38 <- read.table(fns$rmsk) rmskhg38 <- makeGRangesFromDataFrame(rmskhg38,     keep.extra.columns = TRUE,     starts.in.df.are.0based = TRUE ) wgs_bam <- fns$bams[1] rna_bam <- fns$bams[2] fafn <- fns$fasta fp <- FilterParam(     min_depth = 1,     min_base_quality = 30,     min_mapq = c(255, 30),     library_type = c(\"fr-first-strand\", \"genomic-unstranded\"),     trim_5p = 5,     trim_3p = 5,     indel_dist = 4,     homopolymer_len = 6,     max_mismatch_type = c(3, 3),     read_bqual = c(0.25, 20),     only_keep_variants = c(TRUE, FALSE) )  bams <- c(rna_bam, wgs_bam) names(bams) <- c(\"rna\", \"dna\") rse <- pileup_sites(bams,     fafile = fafn,     chrom = \"chr4\",     param = fp )  rse ## class: RangedSummarizedExperiment  ## dim: 546 2  ## metadata(0): ## assays(7): ALT nRef ... nC nG ## rownames(546): chr4-44338-- chr4-124820-+ ... chr4-990981-+ ##   chr4-993342-+ ## rowData names(4): REF rbpz vpb sor ## colnames(2): rna dna ## colData names(1): sample to_keep <- (assay(rse, \"nRef\")[, \"dna\"] >= 5 & assay(rse, \"ALT\")[, \"dna\"] == \"-\") rse <- subsetByOverlaps(rse, rse[to_keep, ], ignore.strand = TRUE) nrow(rse) ## [1] 198 rse <- filter_multiallelic(rse) ## â„¹ `filter_multiallelic()`: removed 0 sites from 198 (198 remain) rse <- calc_edit_frequency(rse) rowData(rse) ## DataFrame with 198 rows and 5 columns ##                       REF      rbpz       vpb       sor         ALT ##               <character> <numeric> <numeric> <numeric> <character> ## chr4-124820-+           C -0.939623       Inf  1.410919           A ## chr4-125213-+           G -1.584745       Inf  0.367725           C ## chr4-126885-+           A  0.826528       Inf  2.271553           G ## chr4-126885--           T       Inf       Inf  2.271553           C ## chr4-126955-+           A  1.584745       Inf  1.506342           G ## ...                   ...       ...       ...       ...         ... ## chr4-958447-+           C  0.694986       Inf  1.436657           A ## chr4-989824-+           C  0.144841       Inf  0.582285           T ## chr4-990589-+           A -1.640049       Inf  1.570697           C ## chr4-990981-+           C -0.925820       Inf  0.891998           T ## chr4-993342-+           A  1.498680       Inf  1.472727           G rse <- annot_from_gr(rse, rmskhg38, cols_to_map = c(c(\"repName\", \"repClass\", \"repFamily\")))  rowData(rse)[c(\"repName\", \"repFamily\")] ## DataFrame with 198 rows and 2 columns ##                   repName   repFamily ##               <character> <character> ## chr4-124820-+          NA          NA ## chr4-125213-+      MER21C        ERVL ## chr4-126885-+          NA          NA ## chr4-126885--      AluSc5         Alu ## chr4-126955-+          NA          NA ## ...                   ...         ... ## chr4-958447-+          NA          NA ## chr4-989824-+          NA          NA ## chr4-990589-+          NA          NA ## chr4-990981-+          NA          NA ## chr4-993342-+          NA          NA rse <- rse[!rowData(rse)$repFamily %in% c(\"Simple_repeat\", \"Low Complexity\")] rse <- filter_clustered_variants(rse, txdb, variant_dist = 100) ## â„¹ `filter_clustered_variants()`: removed 47 sites from 197 (150 remain) rse ## class: RangedSummarizedExperiment  ## dim: 150 2  ## metadata(0): ## assays(9): ALT nRef ... depth edit_freq ## rownames(150): chr4-124820-+ chr4-125213-+ ... chr4-990981-+ ##   chr4-993342-+ ## rowData names(8): REF rbpz ... repClass repFamily ## colnames(2): rna dna ## colData names(3): sample n_sites edit_idx rse <- filter_splice_variants(rse, txdb) ## â„¹ `filter_splice_variants()`: removed 3 sites from 150 (147 remain) rse ## class: RangedSummarizedExperiment  ## dim: 147 2  ## metadata(0): ## assays(9): ALT nRef ... depth edit_freq ## rownames(147): chr4-124820-+ chr4-125213-+ ... chr4-990981-+ ##   chr4-993342-+ ## rowData names(8): REF rbpz ... repClass repFamily ## colnames(2): rna dna ## colData names(3): sample n_sites edit_idx rse <- annot_from_gr(rse, chr4snps, \"name\") rowData(rse)[c(\"name\")] ## DataFrame with 147 rows and 1 column ##                       name ##                <character> ## chr4-124820-+ rs1553807640 ## chr4-125213-+ rs1286128437 ## chr4-126885-+           NA ## chr4-126885--           NA ## chr4-126955-+           NA ## ...                    ... ## chr4-958447-+ rs1052651854 ## chr4-989824-+   rs73219719 ## chr4-990589-+           NA ## chr4-990981-+  rs116514520 ## chr4-993342-+           NA rse <- rse[is.na(rowData(rse)$name), ] rse ## class: RangedSummarizedExperiment  ## dim: 89 2  ## metadata(0): ## assays(9): ALT nRef ... depth edit_freq ## rownames(89): chr4-126885-+ chr4-126885-- ... chr4-990589-+ ##   chr4-993342-+ ## rowData names(9): REF rbpz ... repFamily name ## colnames(2): rna dna ## colData names(3): sample n_sites edit_idx to_keep <- assay(rse, \"edit_freq\")[, 1] > 0.05 rse <- rse[to_keep, ]  rse <- rse[assay(rse, \"nAlt\")[, 1] >= 2] stopifnot(all(rowData(rse)$REF == \"A\" & rowData(rse)$ALT == \"G\")) rowRanges(rse) ## GRanges object with 10 ranges and 9 metadata columns: ##                 seqnames    ranges strand |         REF       rbpz ##                    <Rle> <IRanges>  <Rle> | <character>  <numeric> ##   chr4-134353-+     chr4    134353      + |           A -1.1811989 ##   chr4-378011-+     chr4    378011      + |           A -0.0481455 ##   chr4-378018-+     chr4    378018      + |           A -0.3099735 ##   chr4-378090-+     chr4    378090      + |           A  0.0000000 ##   chr4-378362-+     chr4    378362      + |           A  0.2155896 ##   chr4-378368-+     chr4    378368      + |           A  1.0966509 ##   chr4-378409-+     chr4    378409      + |           A  0.7311006 ##   chr4-380392-+     chr4    380392      + |           A  0.3325434 ##   chr4-778739--     chr4    778739      - |           A  0.5773503 ##   chr4-778780--     chr4    778780      - |           A -0.8660254 ##                       vpb       sor         ALT     repName    repClass ##                 <numeric> <numeric> <character> <character> <character> ##   chr4-134353-+  0.100000 0.5273549           G        <NA>        <NA> ##   chr4-378011-+  0.840000 0.5508310           G       AluSc        SINE ##   chr4-378018-+  0.535497 1.0706105           G       AluSc        SINE ##   chr4-378090-+  0.700000 0.3231611           G       AluSc        SINE ##   chr4-378362-+  0.180000 0.0392207           G        <NA>        <NA> ##   chr4-378368-+  0.180000 0.2689899           G        <NA>        <NA> ##   chr4-378409-+  0.580000 0.8919980           G        <NA>        <NA> ##   chr4-380392-+  0.520000 0.4245653           G      AluSq2        SINE ##   chr4-778739--  0.230191 0.6685414           G       AluSg        SINE ##   chr4-778780--  0.303109 1.8855955           G       AluSg        SINE ##                   repFamily        name ##                 <character> <character> ##   chr4-134353-+        <NA>        <NA> ##   chr4-378011-+         Alu        <NA> ##   chr4-378018-+         Alu        <NA> ##   chr4-378090-+         Alu        <NA> ##   chr4-378362-+        <NA>        <NA> ##   chr4-378368-+        <NA>        <NA> ##   chr4-378409-+        <NA>        <NA> ##   chr4-380392-+         Alu        <NA> ##   chr4-778739--         Alu        <NA> ##   chr4-778780--         Alu        <NA> ##   ------- ##   seqinfo: 194 sequences from an unspecified genome sessionInfo() ## R version 4.3.0 (2023-04-21) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.2 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] TxDb.Hsapiens.UCSC.hg38.knownGene_3.17.0 ##  [2] rtracklayer_1.60.0                       ##  [3] SummarizedExperiment_1.30.1              ##  [4] MatrixGenerics_1.12.0                    ##  [5] matrixStats_0.63.0                       ##  [6] GenomicFeatures_1.52.0                   ##  [7] AnnotationDbi_1.62.1                     ##  [8] Biobase_2.60.0                           ##  [9] GenomicRanges_1.52.0                     ## [10] GenomeInfoDb_1.36.0                      ## [11] IRanges_2.34.0                           ## [12] S4Vectors_0.38.1                         ## [13] BiocGenerics_0.46.0                      ## [14] raer_0.99.0                              ## [15] BiocStyle_2.28.0                         ##  ## loaded via a namespace (and not attached): ##  [1] tidyselect_1.2.0         dplyr_1.1.2              ##  [3] blob_1.2.4               filelock_1.0.2           ##  [5] Biostrings_2.68.0        bitops_1.0-7             ##  [7] fastmap_1.1.1            RCurl_1.98-1.12          ##  [9] BiocFileCache_2.8.0      GenomicAlignments_1.36.0 ## [11] XML_3.99-0.14            digest_0.6.31            ## [13] lifecycle_1.0.3          KEGGREST_1.40.0          ## [15] RSQLite_2.3.1            magrittr_2.0.3           ## [17] compiler_4.3.0           progress_1.2.2           ## [19] rlang_1.1.1              sass_0.4.6               ## [21] tools_4.3.0              utf8_1.2.3               ## [23] yaml_2.3.7               data.table_1.14.8        ## [25] knitr_1.42               prettyunits_1.1.1        ## [27] S4Arrays_1.0.4           bit_4.0.5                ## [29] curl_5.0.0               DelayedArray_0.26.2      ## [31] xml2_1.3.4               BiocParallel_1.34.1      ## [33] withr_2.5.0              purrr_1.0.1              ## [35] desc_1.4.2               grid_4.3.0               ## [37] fansi_1.0.4              biomaRt_2.56.0           ## [39] cli_3.6.1                rmarkdown_2.21           ## [41] crayon_1.5.2             ragg_1.2.5               ## [43] generics_0.1.3           httr_1.4.6               ## [45] rjson_0.2.21             DBI_1.1.3                ## [47] cachem_1.0.8             stringr_1.5.0            ## [49] zlibbioc_1.46.0          parallel_4.3.0           ## [51] BiocManager_1.30.20      XVector_0.40.0           ## [53] restfulr_0.0.15          vctrs_0.6.2              ## [55] Matrix_1.5-4             jsonlite_1.8.4           ## [57] bookdown_0.34            hms_1.1.3                ## [59] bit64_4.0.5              systemfonts_1.0.4        ## [61] jquerylib_0.1.4          glue_1.6.2               ## [63] pkgdown_2.0.7            codetools_0.2-19         ## [65] stringi_1.7.12           BiocIO_1.10.0            ## [67] tibble_3.2.1             pillar_1.9.0             ## [69] rappdirs_0.3.3           htmltools_0.5.5          ## [71] GenomeInfoDbData_1.2.10  BSgenome_1.68.0          ## [73] R6_2.5.1                 dbplyr_2.3.2             ## [75] textshaping_0.3.6        rprojroot_2.0.3          ## [77] evaluate_0.21            lattice_0.21-8           ## [79] png_0.1-8                Rsamtools_2.16.0         ## [81] memoise_2.0.1            bslib_0.4.2              ## [83] xfun_0.39                fs_1.6.2                 ## [85] pkgconfig_2.0.3"},{"path":"https://rnabioco.github.io/raer/articles/raer.html","id":"differential-editing-tutorial","dir":"Articles","previous_headings":"","what":"Differential Editing tutorial","title":"Introducing the raer package","text":"vignette demonstrate identify RNA editing sites condition-specific editing frequencies using raer package.","code":""},{"path":"https://rnabioco.github.io/raer/articles/raer.html","id":"set-up","dir":"Articles","previous_headings":"Differential Editing tutorial","what":"Set up","title":"Introducing the raer package","text":"vignette public RNA-seq dataset analyzed, GSE99249, consists ADAR1 mutants control human cell lines, conditionally treated Interferon-Beta. simplicity examine ADAR1 WT KO samples treated IFN-B, triplicate samples. Aligned BAM files necessary files preprocessed vignette. files occupy ~250 Mb space stored BiocFileCache. Next â€™ll collect vector containing paths BAM file BAM files subset full BAM files, containing alignments chromosome 18. Next â€™ll need FASTA file quantify editing sites. â€™ll use FASTA file containing chromosome 18 demo. fasta can compressed. Lastly, â€™ll use BED file containing coordinates known human editing sites REDIPortal database. file can also optionally compressed.","code":"library(raer) library(SummarizedExperiment) library(DESeq2) library(ComplexHeatmap) library(viridis) library(rtracklayer) fns <- download_GSE99249() bam_files <- fns$bams bam_files[1:2] ## [1] \"/github/home/.cache/R/raer/SRR5564260_dedup_sorted.bam\" ## [2] \"/github/home/.cache/R/raer/SRR5564261_dedup_sorted.bam\" fafn <- fns$fasta fafn ## [1] \"/github/home/.cache/R/raer/5c96c36be13_chr18.fasta.bgz\" sites <- import(fns$bed) sites ## GRanges object with 250442 ranges and 2 metadata columns: ##            seqnames    ranges strand |             name     score ##               <Rle> <IRanges>  <Rle> |      <character> <numeric> ##        [1]    chr18     22898      + |    chr18:22898:+         0 ##        [2]    chr18     22909      + |    chr18:22909:+         0 ##        [3]    chr18     22932      + |    chr18:22932:+         0 ##        [4]    chr18     22942      + |    chr18:22942:+         0 ##        [5]    chr18     22948      + |    chr18:22948:+         0 ##        ...      ...       ...    ... .              ...       ... ##   [250438]    chr18  80251604      + | chr18:80251604:+         0 ##   [250439]    chr18  80251607      + | chr18:80251607:+         0 ##   [250440]    chr18  80251609      + | chr18:80251609:+         0 ##   [250441]    chr18  80251634      + | chr18:80251634:+         0 ##   [250442]    chr18  80251647      + | chr18:80251647:+         0 ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths"},{"path":"https://rnabioco.github.io/raer/articles/raer.html","id":"generate-editing-site-read-counts","dir":"Articles","previous_headings":"Differential Editing tutorial","what":"Generate editing site read counts","title":"Introducing the raer package","text":"pileup_sites() function calculate base counts across multiple BAM files. base counts returned list GRanges objects bam file. FilterParam() function provides numerous filters exclude reads bases based commonly used filters detecting RNA-editing events. Specific regions can queried using region argument, specific positions can queried providing bedfile path BED-file. Internally, pileup_sites() generate pileups memory. However, files can also stored tabix-indexed format, later retrieval, querying specific regions. Pileups data stored summarizedExperiment object, permits comparisons across sample. rowData() rowRanges() slots can populated information related editing site, similarly colData() slot can used store sample metadata. summarizedExperiment object can also interface derivative classes, singleCellExperiment(). base counts counted stand specific fashion depending library-type parameter. REF ALT bases reference strand. Next add sample metadata summarizedExperiment, used conduct differential editing analysis.","code":"fp <- FilterParam(     only_keep_variants = TRUE,     trim_5p = 5,     trim_3p = 5,     min_base_quality = 30L,     min_mapq = 255L,     library_type = \"fr-first-strand\",     min_splice_overhang = 10 )  rse <- pileup_sites(bam_files,     fafile = fafn,     sites = sites,     region = \"chr18\",     param = fp ) rse ## class: RangedSummarizedExperiment  ## dim: 6287 6  ## metadata(0): ## assays(7): ALT nRef ... nC nG ## rownames(6287): chr18-168574-+ chr18-168577-+ ... ##   chr18-80172518-- chr18-80174441-- ## rowData names(4): REF rbpz vpb sor ## colnames(6): SRR5564260_dedup_sorted.bam ##   SRR5564261_dedup_sorted.bam ... SRR5564271_dedup_sorted.bam ##   SRR5564277_dedup_sorted.bam ## colData names(1): sample colData(rse)$genotype_treatment <- rep(     c(         \"ADAR1KO Interferon beta\",         \"Wildtype Interferon beta\"     ),     each = 3 )  colData(rse)$genotype <- rep(     c(         \"ADAR1KO\",         \"Wildtype\"     ),     each = 3 ) colData(rse) ## DataFrame with 6 rows and 3 columns ##                                             sample     genotype_treatment ##                                        <character>            <character> ## SRR5564260_dedup_sorted.bam SRR5564260_dedup_sor.. ADAR1KO Interferon b.. ## SRR5564261_dedup_sorted.bam SRR5564261_dedup_sor.. ADAR1KO Interferon b.. ## SRR5564269_dedup_sorted.bam SRR5564269_dedup_sor.. ADAR1KO Interferon b.. ## SRR5564270_dedup_sorted.bam SRR5564270_dedup_sor.. Wildtype Interferon .. ## SRR5564271_dedup_sorted.bam SRR5564271_dedup_sor.. Wildtype Interferon .. ## SRR5564277_dedup_sorted.bam SRR5564277_dedup_sor.. Wildtype Interferon .. ##                                genotype ##                             <character> ## SRR5564260_dedup_sorted.bam     ADAR1KO ## SRR5564261_dedup_sorted.bam     ADAR1KO ## SRR5564269_dedup_sorted.bam     ADAR1KO ## SRR5564270_dedup_sorted.bam    Wildtype ## SRR5564271_dedup_sorted.bam    Wildtype ## SRR5564277_dedup_sorted.bam    Wildtype"},{"path":"https://rnabioco.github.io/raer/articles/raer.html","id":"prepare-for-differential-editing","dir":"Articles","previous_headings":"Differential Editing tutorial","what":"Prepare for differential editing","title":"Introducing the raer package","text":"next use calc_edit_frequency function identify percent edits position sample. drop = TRUE argument also exclude sites without adenosine. editing frequencies used differential editing analysis, conducted using raw counts, however useful filtering visualization. can next subset summarizedExperiment object exclude low frequency editing events. analysis require editing site shows editing least 1 sample, least 5 counts sample. object filtered, can prepare DE. means making new object contains assay read counts alt ref alleles single matrix.","code":"se_filtered <- calc_edit_frequency(rse,     edit_from = \"A\",     edit_to = \"G\",     drop = TRUE ) has_editing <- rowSums(assay(se_filtered, \"edit_freq\") > 0) >= 1 has_depth <- rowSums(((assay(se_filtered, \"nRef\") +     assay(se_filtered, \"nAlt\")) >= 5)) == ncol(se_filtered)  se_filtered <- se_filtered[has_editing & has_depth, ] se_filtered ## class: RangedSummarizedExperiment  ## dim: 608 6  ## metadata(0): ## assays(9): ALT nRef ... depth edit_freq ## rownames(608): chr18-204625-+ chr18-204626-+ ... chr18-80158602-- ##   chr18-80158603-- ## rowData names(4): REF rbpz vpb sor ## colnames(6): SRR5564260_dedup_sorted.bam ##   SRR5564261_dedup_sorted.bam ... SRR5564271_dedup_sorted.bam ##   SRR5564277_dedup_sorted.bam ## colData names(5): sample genotype_treatment genotype n_sites ##   edit_idx deobj <- prep_for_de(se_filtered,     min_prop = 0.1,     max_prop = 0.9,     min_samples = 3 )  assay(deobj, \"counts\")[1:3, 1:6] ##                  SRR5564260_dedup_sorted.bam_ref ## chr18-692390--                                 6 ## chr18-692402--                                 5 ## chr18-21631169-+                               8 ##                  SRR5564261_dedup_sorted.bam_ref ## chr18-692390--                                12 ## chr18-692402--                                10 ## chr18-21631169-+                              10 ##                  SRR5564269_dedup_sorted.bam_ref ## chr18-692390--                                13 ## chr18-692402--                                13 ## chr18-21631169-+                              15 ##                  SRR5564270_dedup_sorted.bam_ref ## chr18-692390--                                18 ## chr18-692402--                                14 ## chr18-21631169-+                              10 ##                  SRR5564271_dedup_sorted.bam_ref ## chr18-692390--                                13 ## chr18-692402--                                10 ## chr18-21631169-+                               3 ##                  SRR5564277_dedup_sorted.bam_ref ## chr18-692390--                                 8 ## chr18-692402--                                 3 ## chr18-21631169-+                               4"},{"path":"https://rnabioco.github.io/raer/articles/raer.html","id":"run-differential-editing-deseq2","dir":"Articles","previous_headings":"Differential Editing tutorial","what":"Run differential editing (DESeq2)","title":"Introducing the raer package","text":"stage, can use object perform DE can continue pre built functions differential editing, use design design <- ~0 + condition:sample + condition:count. samples, can leave combine sample name shows treatment control. results identical close. hands, genes come , p values log fold change values slightly different. probably best update levels object, donâ€™t, still work. returns list containing dds object, full results, significant results, model matrix.","code":"de_results <- perform_de(deobj,     sample_col = \"sample\",     condition_col = \"genotype\",     condition_control = \"Wildtype\",     condition_treatment = \"ADAR1KO\" ) de_results$sig_results[1:5, ] ##                      logFC   logCPM        LR       PValue      FDR ## chr18-50393235-+ -8.033976 21.73892 11.360332 0.0007502942 0.020463 ## chr18-35248579-+ -8.129393 22.69356 10.096657 0.0014853852 0.020463 ## chr18-23297504-- -7.692014 21.72512 10.028647 0.0015412421 0.020463 ## chr18-21631272-+ -7.091754 20.75260  9.796561 0.0017483853 0.020463 ## chr18-50392804-+ -7.446234 21.07996  9.785101 0.0017593156 0.020463 top_sites <- rownames(de_results$sig_results)[1:20]  Heatmap(assay(se_filtered, \"edit_freq\")[top_sites, ],     col = viridis(100),     column_labels = se_filtered$genotype_treatment ) sessionInfo() ## R version 4.3.0 (2023-04-21) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.2 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] grid      stats4    stats     graphics  grDevices utils     datasets  ## [8] methods   base      ##  ## other attached packages: ##  [1] rtracklayer_1.60.0          viridis_0.6.3               ##  [3] viridisLite_0.4.2           ComplexHeatmap_2.16.0       ##  [5] DESeq2_1.40.1               SummarizedExperiment_1.30.1 ##  [7] Biobase_2.60.0              GenomicRanges_1.52.0        ##  [9] GenomeInfoDb_1.36.0         IRanges_2.34.0              ## [11] S4Vectors_0.38.1            BiocGenerics_0.46.0         ## [13] MatrixGenerics_1.12.0       matrixStats_0.63.0          ## [15] raer_0.99.0                 BiocStyle_2.28.0            ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.1.3                bitops_1.0-7             ##   [3] gridExtra_2.3            biomaRt_2.56.0           ##   [5] rlang_1.1.1              magrittr_2.0.3           ##   [7] clue_0.3-64              GetoptLong_1.0.5         ##   [9] compiler_4.3.0           RSQLite_2.3.1            ##  [11] GenomicFeatures_1.52.0   png_0.1-8                ##  [13] systemfonts_1.0.4        vctrs_0.6.2              ##  [15] stringr_1.5.0            shape_1.4.6              ##  [17] pkgconfig_2.0.3          crayon_1.5.2             ##  [19] fastmap_1.1.1            dbplyr_2.3.2             ##  [21] XVector_0.40.0           utf8_1.2.3               ##  [23] Rsamtools_2.16.0         rmarkdown_2.21           ##  [25] ragg_1.2.5               purrr_1.0.1              ##  [27] bit_4.0.5                xfun_0.39                ##  [29] zlibbioc_1.46.0          cachem_1.0.8             ##  [31] jsonlite_1.8.4           progress_1.2.2           ##  [33] blob_1.2.4               highr_0.10               ##  [35] DelayedArray_0.26.2      BiocParallel_1.34.1      ##  [37] cluster_2.1.4            parallel_4.3.0           ##  [39] prettyunits_1.1.1        R6_2.5.1                 ##  [41] RColorBrewer_1.1-3       bslib_0.4.2              ##  [43] stringi_1.7.12           limma_3.56.1             ##  [45] jquerylib_0.1.4          iterators_1.0.14         ##  [47] Rcpp_1.0.10              bookdown_0.34            ##  [49] knitr_1.42               splines_4.3.0            ##  [51] Matrix_1.5-4             tidyselect_1.2.0         ##  [53] yaml_2.3.7               doParallel_1.0.17        ##  [55] codetools_0.2-19         curl_5.0.0               ##  [57] lattice_0.21-8           tibble_3.2.1             ##  [59] withr_2.5.0              KEGGREST_1.40.0          ##  [61] evaluate_0.21            desc_1.4.2               ##  [63] BiocFileCache_2.8.0      xml2_1.3.4               ##  [65] circlize_0.4.15          Biostrings_2.68.0        ##  [67] pillar_1.9.0             BiocManager_1.30.20      ##  [69] filelock_1.0.2           foreach_1.5.2            ##  [71] generics_0.1.3           rprojroot_2.0.3          ##  [73] RCurl_1.98-1.12          hms_1.1.3                ##  [75] ggplot2_3.4.2            munsell_0.5.0            ##  [77] scales_1.2.1             glue_1.6.2               ##  [79] tools_4.3.0              BiocIO_1.10.0            ##  [81] data.table_1.14.8        BSgenome_1.68.0          ##  [83] locfit_1.5-9.7           GenomicAlignments_1.36.0 ##  [85] fs_1.6.2                 XML_3.99-0.14            ##  [87] Cairo_1.6-0              edgeR_3.42.2             ##  [89] AnnotationDbi_1.62.1     colorspace_2.1-0         ##  [91] GenomeInfoDbData_1.2.10  restfulr_0.0.15          ##  [93] cli_3.6.1                rappdirs_0.3.3           ##  [95] textshaping_0.3.6        fansi_1.0.4              ##  [97] S4Arrays_1.0.4           dplyr_1.1.2              ##  [99] gtable_0.3.3             sass_0.4.6               ## [101] digest_0.6.31            rjson_0.2.21             ## [103] memoise_2.0.1            htmltools_0.5.5          ## [105] pkgdown_2.0.7            lifecycle_1.0.3          ## [107] httr_1.4.6               GlobalOptions_0.1.2      ## [109] bit64_4.0.5"},{"path":"https://rnabioco.github.io/raer/articles/single-cell.html","id":"characterizing-rna-editing-sites-in-single-cell-data","dir":"Articles","previous_headings":"","what":"Characterizing RNA editing sites in single cell data","title":"Identifying RNA editing sites in droplet single cell datasets","text":"vignette demonstrate use raer package examine RNA editing droplet-based single cell RNA-seq data.","code":""},{"path":"https://rnabioco.github.io/raer/articles/single-cell.html","id":"preprocessing","dir":"Articles","previous_headings":"Characterizing RNA editing sites in single cell data","what":"Preprocessing","title":"Identifying RNA editing sites in droplet single cell datasets","text":"example analysis use single cell dataset containing human PBMC cells 10x Genomics. single cell data processed using cellranger pipeline. BAM file contains tag (CB) indicates cell-barcode associated alignment, well tag containing inferred UMI sequence (UB).","code":""},{"path":"https://rnabioco.github.io/raer/articles/single-cell.html","id":"single-cell-editing-analysis","dir":"Articles","previous_headings":"Characterizing RNA editing sites in single cell data","what":"Single cell editing analysis","title":"Identifying RNA editing sites in droplet single cell datasets","text":"subset human PBMC scRNA-seq dataset 10x Genomics, along needed files can downloaded using download_human_pbmc(). Next â€™ll load SingleCellExperiment cell-type annotations.  Next â€™ll select editing sites query. analysis use sites Rediportal database. editing sites interest known, one option perform two pass operation. First, identify editing sites treating data bulk-RNA-seq experiment, using example pileup_sites(). filter sites establish set high confidence sites query single cell mode. raer provides function, pileup_cells(), quantify edited non-edited UMI counts per cell barcode, collect site counts SingleCellExperiment. sites quantified specified using custom formatted GRanges object 1 base intervals, strand (+ -), supplemented metadata columns named ref alt containing reference alternate base query. case interested ->editing, set ref alt G. Note ref alt bases reference strand. - strand interval bases complement + strand bases. pileup_cells() accepts FilterParam() class specifying performing read site filtering. Note pileup_cells() strand sensitive default, important ensure strand input sites correctly annotated, library type correct type data interest. 10x Genomics data, library type set fr-second-strand, indicating strand alignments matches strand RNA. Note bam_flags set include duplicate reads default. bamfile tag UMI sequence, can supplied umi_tag argument count 1 read CB-UMI pair position. strategy allows reads UMI counted multiple independent sites enabling recovery sequence variants counting 1 read per UMI. Processing time can reduced operating parallel across chromosomes, supplying BiocParallel backend BPPARAM argument (e.g.Â MultiCoreParam()). Next â€™ll filter pileups find sites least 5 cells editing event, add editing information SingleCellExperiment altExp(). editing sites added gene expression SingleCellExperiment can use plotting methods previously developed single cell analysis. â€™ll visualize editing sites highest edited read counts.      Alternatively can view top edited sites Heatmap, showing average number edited reads per site cell type.  Various tools Bioconductor can used provide additional annotation information RNA editing site. VariantAnnotation package provides powerful functionality annotate location editing site, provide information alterations codons splice sites.","code":"fns <- download_human_pbmc() fns ## $bam ## [1] \"/github/home/.cache/R/raer/10k_PBMC_3p_nextgem_Chromium_X_intron_possorted_chr16_rp.bam\" ##  ## $bai ## [1] \"/github/home/.cache/R/raer/10k_PBMC_3p_nextgem_Chromium_X_intron_possorted_chr16_rp.bam.bai\" ##  ## $edit_sites ## [1] \"/github/home/.cache/R/raer/5c940f65ed3_rediportal_chr16.bed.gz\" ##  ## $sce ## [1] \"/github/home/.cache/R/raer/5c932f56b89_sce.rds\" bam_fn <- fns$bam bed_fn <- fns$edit_sites sce <- readRDS(fns$sce) sce ## class: SingleCellExperiment  ## dim: 36601 500  ## metadata(2): Samples mkrs ## assays(2): counts logcounts ## rownames(36601): MIR1302-2HG FAM138A ... AC007325.4 AC007325.2 ## rowData names(3): ID Symbol Type ## colnames(500): TGTTTGTCAGTTAGGG-1 ATCTCTACAAGCTACT-1 ... ##   GGGCGTTTCAGGACGA-1 CTATAGGAGATTGTGA-1 ## colData names(8): Sample Barcode ... r celltype ## reducedDimNames(2): PCA UMAP ## mainExpName: NULL ## altExpNames(0): plotUMAP(sce, colour_by = \"celltype\") gr <- import(bed_fn) gr$name <- NULL gr$score <- NULL gr$REF <- \"A\" gr$ALT <- \"G\" gr ## GRanges object with 785208 ranges and 2 metadata columns: ##            seqnames    ranges strand |         REF         ALT ##               <Rle> <IRanges>  <Rle> | <character> <character> ##        [1]    chr16     22083      - |           A           G ##        [2]    chr16     22101      - |           A           G ##        [3]    chr16     22107      - |           A           G ##        [4]    chr16     22113      - |           A           G ##        [5]    chr16     22114      - |           A           G ##        ...      ...       ...    ... .         ...         ... ##   [785204]    chr16  90219996      + |           A           G ##   [785205]    chr16  90220035      + |           A           G ##   [785206]    chr16  90220081      + |           A           G ##   [785207]    chr16  90220095      + |           A           G ##   [785208]    chr16  90220135      + |           A           G ##   ------- ##   seqinfo: 1 sequence from an unspecified genome; no seqlengths outdir <- file.path(tempdir(), \"sc_edits\") cbs <- colnames(sce) e_sce <- pileup_cells(     bamfile = bam_fn,     sites = gr,     cell_barcodes = cbs,     output_directory = outdir,     cb_tag = \"CB\",     umi_tag = \"UB\",     param = FilterParam(         min_base_quality = 30L,         library_type = \"fr-second-strand\",         min_variant_reads = 1L,         trim_5p = 5L,         trim_3p = 5L     ),     verbose = FALSE ) e_sce ## class: SingleCellExperiment  ## dim: 4427 500  ## metadata(0): ## assays(2): nRef nAlt ## rownames(4427): chr16:83540_1_A_G chr16:83621_1_A_G ... ##   chr16:31453268_2_A_G chr16:31454303_2_A_G ## rowData names(2): ref alt ## colnames(500): TGTTTGTCAGTTAGGG-1 ATCTCTACAAGCTACT-1 ... ##   GGGCGTTTCAGGACGA-1 CTATAGGAGATTGTGA-1 ## colData names(1): id ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0): dir(outdir) ## [1] \"barcodes.txt.gz\" \"counts.mtx.gz\"   \"sites.txt.gz\" e_sce <- e_sce[rowSums(assays(e_sce)$nAlt > 0) >= 5, ] e_sce <- calc_edit_frequency(e_sce, replace_na = FALSE) altExp(sce) <- e_sce[, colnames(sce)] to_plot <- rownames(altExp(sce))[order(rowSums(assay(altExp(sce), \"nAlt\")), decreasing = TRUE)]  lapply(to_plot[1:5], function(x) {     plotUMAP(sce, colour_by = x, by_exprs_values = \"nAlt\") }) ## [[1]] ##  ## [[2]] ##  ## [[3]] ##  ## [[4]] ##  ## [[5]] altExp(sce)$cell_type <- sce$celltype  plotGroupedHeatmap(altExp(sce),     features = to_plot[1:25],     group = \"cell_type\",     exprs_values = \"nAlt\" ) sessionInfo() ## R version 4.3.0 (2023-04-21) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.2 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] rtracklayer_1.60.0          Rsamtools_2.16.0            ##  [3] Biostrings_2.68.0           XVector_0.40.0              ##  [5] scater_1.28.0               ggplot2_3.4.2               ##  [7] scuttle_1.10.1              SingleCellExperiment_1.22.0 ##  [9] SummarizedExperiment_1.30.1 Biobase_2.60.0              ## [11] GenomicRanges_1.52.0        GenomeInfoDb_1.36.0         ## [13] IRanges_2.34.0              S4Vectors_0.38.1            ## [15] BiocGenerics_0.46.0         MatrixGenerics_1.12.0       ## [17] matrixStats_0.63.0          raer_0.99.0                 ## [19] BiocStyle_2.28.0            ##  ## loaded via a namespace (and not attached): ##   [1] RColorBrewer_1.1-3        jsonlite_1.8.4            ##   [3] magrittr_2.0.3            ggbeeswarm_0.7.2          ##   [5] GenomicFeatures_1.52.0    farver_2.1.1              ##   [7] rmarkdown_2.21            fs_1.6.2                  ##   [9] BiocIO_1.10.0             zlibbioc_1.46.0           ##  [11] ragg_1.2.5                vctrs_0.6.2               ##  [13] memoise_2.0.1             DelayedMatrixStats_1.22.0 ##  [15] RCurl_1.98-1.12           htmltools_0.5.5           ##  [17] S4Arrays_1.0.4            progress_1.2.2            ##  [19] curl_5.0.0                BiocNeighbors_1.18.0      ##  [21] sass_0.4.6                bslib_0.4.2               ##  [23] desc_1.4.2                cachem_1.0.8              ##  [25] GenomicAlignments_1.36.0  lifecycle_1.0.3           ##  [27] pkgconfig_2.0.3           rsvd_1.0.5                ##  [29] Matrix_1.5-4              R6_2.5.1                  ##  [31] fastmap_1.1.1             GenomeInfoDbData_1.2.10   ##  [33] digest_0.6.31             colorspace_2.1-0          ##  [35] AnnotationDbi_1.62.1      rprojroot_2.0.3           ##  [37] irlba_2.3.5.1             textshaping_0.3.6         ##  [39] RSQLite_2.3.1             beachmat_2.16.0           ##  [41] filelock_1.0.2            labeling_0.4.2            ##  [43] fansi_1.0.4               httr_1.4.6                ##  [45] compiler_4.3.0            bit64_4.0.5               ##  [47] withr_2.5.0               BiocParallel_1.34.1       ##  [49] viridis_0.6.3             DBI_1.1.3                 ##  [51] highr_0.10                biomaRt_2.56.0            ##  [53] rappdirs_0.3.3            DelayedArray_0.26.2       ##  [55] rjson_0.2.21              tools_4.3.0               ##  [57] vipor_0.4.5               beeswarm_0.4.0            ##  [59] glue_1.6.2                restfulr_0.0.15           ##  [61] grid_4.3.0                generics_0.1.3            ##  [63] gtable_0.3.3              BSgenome_1.68.0           ##  [65] data.table_1.14.8         hms_1.1.3                 ##  [67] BiocSingular_1.16.0       ScaledMatrix_1.8.1        ##  [69] xml2_1.3.4                utf8_1.2.3                ##  [71] ggrepel_0.9.3             pillar_1.9.0              ##  [73] stringr_1.5.0             dplyr_1.1.2               ##  [75] BiocFileCache_2.8.0       lattice_0.21-8            ##  [77] bit_4.0.5                 tidyselect_1.2.0          ##  [79] knitr_1.42                gridExtra_2.3             ##  [81] bookdown_0.34             xfun_0.39                 ##  [83] pheatmap_1.0.12           stringi_1.7.12            ##  [85] yaml_2.3.7                evaluate_0.21             ##  [87] codetools_0.2-19          tibble_3.2.1              ##  [89] BiocManager_1.30.20       cli_3.6.1                 ##  [91] systemfonts_1.0.4         munsell_0.5.0             ##  [93] jquerylib_0.1.4           Rcpp_1.0.10               ##  [95] dbplyr_2.3.2              png_0.1-8                 ##  [97] XML_3.99-0.14             parallel_4.3.0            ##  [99] pkgdown_2.0.7             blob_1.2.4                ## [101] prettyunits_1.1.1         sparseMatrixStats_1.12.0  ## [103] bitops_1.0-7              viridisLite_0.4.2         ## [105] scales_1.2.1              purrr_1.0.1               ## [107] crayon_1.5.2              rlang_1.1.1               ## [109] KEGGREST_1.40.0"},{"path":"https://rnabioco.github.io/raer/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kent Riemondy. Author, maintainer. Kristen Wells-Wrasman. Author. Ryan Sheridan. Contributor. Jay Hesselberth. Contributor. . Copyright holder, funder.","code":""},{"path":"https://rnabioco.github.io/raer/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Riemondy K, Wells-Wrasman K (2023). raer: RNA editing tools R. https://rnabioco.github.io/raer, https://github.com/rnabioco/raer.","code":"@Manual{,   title = {raer: RNA editing tools in R},   author = {Kent Riemondy and Kristen Wells-Wrasman},   year = {2023},   note = {https://rnabioco.github.io/raer, https://github.com/rnabioco/raer}, }"},{"path":"https://rnabioco.github.io/raer/index.html","id":"raer-","dir":"","previous_headings":"","what":"RNA editing tools in R","title":"RNA editing tools in R","text":"raer facilitates analysis RNA adenosine editing Bioconductor ecosystem. ðŸš§ raer active development functionality may change ðŸš§","code":""},{"path":"https://rnabioco.github.io/raer/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"RNA editing tools in R","text":"can install development version raer GitHub :","code":"# install.packages(\"BiocManager\") BiocManager::install(\"rnabioco/raer\")"},{"path":"https://rnabioco.github.io/raer/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"RNA editing tools in R","text":"raer provides methods compute per site read count summaries BAM alignment files, either known editing sites, detected sites. facilitate comparisons across groups, base count data genomic coordinates stored RangedSummarizedExperiment. FilterParam() class holds multiple options customizing output pileup_sites(). pileup_cells() provides support quantifying editing sites single cell libraries.","code":"library(raer) bam1fn <- raer_example(\"SRR5564269_Aligned.sortedByCoord.out.md.bam\") bam2fn <- raer_example(\"SRR5564277_Aligned.sortedByCoord.out.md.bam\") fafn <- raer_example(\"human.fasta\")  bams <- c(\"ko\" = bam1fn, \"wt\" = bam2fn)  rse <- pileup_sites(bams, fafn) suppressMessages(library(SummarizedExperiment)) rse #> class: RangedSummarizedExperiment  #> dim: 1695 2  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(1695): SSR3_1_- SSR3_2_- ... DHFR_517_- DHFR_518_- #> rowData names(4): REF rbpz vpb sor #> colnames(2): ko wt #> colData names(1): sample assays(rse) #> List of length 7 #> names(7): ALT nRef nAlt nA nT nC nG colData(rse) #> DataFrame with 2 rows and 1 column #>         sample #>    <character> #> ko          ko #> wt          wt assays(rse)$nRef[1:4, ] #>          ko wt #> SSR3_1_- 13 12 #> SSR3_2_- 14 12 #> SSR3_3_- 14 12 #> SSR3_4_- 15 12 assays(rse)$nAlt[1:4, ] #>          ko wt #> SSR3_1_-  0  0 #> SSR3_2_-  0  0 #> SSR3_3_-  0  0 #> SSR3_4_-  0  0 fp <- FilterParam(     only_keep_variants = TRUE,     library_type = \"fr-first-strand\",     min_depth = 2 )  rse <- pileup_sites(bams, fafn, param = fp) rse #> class: RangedSummarizedExperiment  #> dim: 74 2  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(74): SSR3_102_- SSR3_125_- ... DHFR_430_- DHFR_513_- #> rowData names(4): REF rbpz vpb sor #> colnames(2): ko wt #> colData names(1): sample scbam_fn <- raer_example(\"5k_neuron_mouse_possort.bam\") outdir <- tempdir(\"sc_editing\")  editing_sites <- GRanges(c(\"2:579:-\",                            \"2:625:-\",                            \"2:589:-\"),                          REF = \"A\",                          ALT = \"G\")  cbs <- c(\"CACCAAACAACAACAA-1\",           \"TATTCCACACCCTCTA-1\",           \"GACCTTCAGTTGTAAG-1\")  sce <- pileup_cells(scbam_fn,                      sites = editing_sites,                     cell_barcodes = cbs,                     param = fp,                      output_directory = outdir) sce #> class: SingleCellExperiment  #> dim: 3 3  #> metadata(0): #> assays(2): nRef nAlt #> rownames(3): 2:579_2_A_G 2:625_2_A_G 2:589_2_A_G #> rowData names(2): ref alt #> colnames(3): CACCAAACAACAACAA-1 TATTCCACACCCTCTA-1 GACCTTCAGTTGTAAG-1 #> colData names(1): id #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): assays(sce)$nRef #> 3 x 3 sparse Matrix of class \"dgCMatrix\" #>             CACCAAACAACAACAA-1 TATTCCACACCCTCTA-1 GACCTTCAGTTGTAAG-1 #> 2:579_2_A_G                  0                  0                  1 #> 2:625_2_A_G                  0                  0                  0 #> 2:589_2_A_G                  1                  1                  2 assays(sce)$nAlt #> 3 x 3 sparse Matrix of class \"dgCMatrix\" #>             CACCAAACAACAACAA-1 TATTCCACACCCTCTA-1 GACCTTCAGTTGTAAG-1 #> 2:579_2_A_G                  1                  1                  1 #> 2:625_2_A_G                  1                  1                  1 #> 2:589_2_A_G                  0                  0                  0"},{"path":"https://rnabioco.github.io/raer/index.html","id":"related-work","dir":"","previous_headings":"","what":"Related work","title":"RNA editing tools in R","text":"Core routines raer implemented using htslib library methods samtools bcftools. raer builds approaches rna editing detection tools: REDItools Picardi E, Pesole G JACUSA2 Piechotta M et al deNovo-Detect Gabey O et al RNAEditingIndexer Roth SH et al SAILOR Washburn MC et al","code":""},{"path":"https://rnabioco.github.io/raer/reference/annot_from_gr.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate a RangedSummarizedExperiment using Granges objects â€” annot_from_gr","title":"Annotate a RangedSummarizedExperiment using Granges objects â€” annot_from_gr","text":"Utility function map annotations GRanges rowData SummarizedExperiment GRanges object. multiple features overlap concatenated comma separated values.","code":""},{"path":"https://rnabioco.github.io/raer/reference/annot_from_gr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate a RangedSummarizedExperiment using Granges objects â€” annot_from_gr","text":"","code":"annot_from_gr(obj, gr, cols_to_map, ...)"},{"path":"https://rnabioco.github.io/raer/reference/annot_from_gr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate a RangedSummarizedExperiment using Granges objects â€” annot_from_gr","text":"obj RangedSummarizedExperiment GRanges object gr GRanges annotations map obj cols_to_map character vector columns gr map obj. vector names, names column names output obj ... additional arguments pass GenomicRanges::findOverlaps()","code":""},{"path":"https://rnabioco.github.io/raer/reference/annot_from_gr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate a RangedSummarizedExperiment using Granges objects â€” annot_from_gr","text":"Either SummarizedExperiment GRanges object additional annotations provided supplied GRanges object.","code":""},{"path":"https://rnabioco.github.io/raer/reference/annot_from_gr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate a RangedSummarizedExperiment using Granges objects â€” annot_from_gr","text":"","code":"library(SummarizedExperiment) #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: â€˜MatrixGenericsâ€™ #> The following objects are masked from â€˜package:matrixStatsâ€™: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, #>     colOrderStats, colProds, colQuantiles, colRanges, colRanks, #>     colSdDiffs, colSds, colSums2, colTabulates, colVarDiffs, #>     colVars, colWeightedMads, colWeightedMeans, #>     colWeightedMedians, colWeightedSds, colWeightedVars, rowAlls, #>     rowAnyNAs, rowAnys, rowAvgsPerColSet, rowCollapse, rowCounts, #>     rowCummaxs, rowCummins, rowCumprods, rowCumsums, rowDiffs, #>     rowIQRDiffs, rowIQRs, rowLogSumExps, rowMadDiffs, rowMads, #>     rowMaxs, rowMeans2, rowMedians, rowMins, rowOrderStats, #>     rowProds, rowQuantiles, rowRanges, rowRanks, rowSdDiffs, #>     rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: â€˜BiocGenericsâ€™ #> The following objects are masked from â€˜package:statsâ€™: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from â€˜package:baseâ€™: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, #>     append, as.data.frame, basename, cbind, colnames, dirname, #>     do.call, duplicated, eval, evalq, get, grep, grepl, #>     intersect, is.unsorted, lapply, mapply, match, mget, order, #>     paste, pmax, pmax.int, pmin, pmin.int, rank, rbind, rownames, #>     sapply, setdiff, sort, table, tapply, union, unique, unsplit, #>     which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: â€˜S4Vectorsâ€™ #> The following object is masked from â€˜package:utilsâ€™: #>  #>     findMatches #> The following objects are masked from â€˜package:baseâ€™: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages #>     'citation(\"pkgname\")'. #>  #> Attaching package: â€˜Biobaseâ€™ #> The following object is masked from â€˜package:MatrixGenericsâ€™: #>  #>     rowMedians #> The following objects are masked from â€˜package:matrixStatsâ€™: #>  #>     anyMissing, rowMedians data(rse_adar_ifn) gr <- GRanges(rep(c(\"SSR3\", \"SPCS3\"), c(5, 15)),               IRanges(seq(1, 500, by = 25), width = 50),               strand = \"+\")  gr$feature <- sample(1:100, size = 20) gr$id <- sample(LETTERS, size = 20)  rse <- annot_from_gr(rse_adar_ifn, gr, c(feature_set = \"feature\", \"id\")) rowData(rse) #> DataFrame with 74 rows and 6 columns #>                    REF       rbpz        vpb       sor feature_set #>            <character>  <numeric>  <numeric> <numeric> <character> #> SSR3_102_-           T   1.489645        Inf  1.403164          NA #> SSR3_125_-           C   0.356711        Inf  0.165499          NA #> SSR3_156_-           C   1.073919        Inf  1.442924          NA #> SSR3_176_-           A  -0.387238 0.00686469  1.987570          NA #> SSR3_198_-           A   1.040581        Inf  1.483784          NA #> ...                ...        ...        ...       ...         ... #> DHFR_397_-           A -1.5715051        Inf   1.39896          NA #> DHFR_399_-           G -0.1203878        Inf   0.09602          NA #> DHFR_423_-           T -0.0468703        Inf   1.38985          NA #> DHFR_430_-           A -1.5389404        Inf   1.39019          NA #> DHFR_513_-           T -0.7160074        Inf   1.38637          NA #>                     id #>            <character> #> SSR3_102_-          NA #> SSR3_125_-          NA #> SSR3_156_-          NA #> SSR3_176_-          NA #> SSR3_198_-          NA #> ...                ... #> DHFR_397_-          NA #> DHFR_399_-          NA #> DHFR_423_-          NA #> DHFR_430_-          NA #> DHFR_513_-          NA"},{"path":"https://rnabioco.github.io/raer/reference/annot_snps.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate known SNP positions â€” annot_snps","title":"Annotate known SNP positions â€” annot_snps","text":"function annotate GRanges rowRanges SummarizedExperiment SNPs SNP package.","code":""},{"path":"https://rnabioco.github.io/raer/reference/annot_snps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate known SNP positions â€” annot_snps","text":"","code":"annot_snps(obj, ...)  # S3 method for GRanges annot_snps(   obj,   dbsnp,   chrom = NULL,   col_to_aggr = \"RefSNP_id\",   drop = FALSE,   genome = NULL,   ... )  # S3 method for SummarizedExperiment annot_snps(   obj,   dbsnp,   chrom = NULL,   col_to_aggr = \"RefSNP_id\",   drop = FALSE,   genome = NULL,   ... )"},{"path":"https://rnabioco.github.io/raer/reference/annot_snps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate known SNP positions â€” annot_snps","text":"obj GRanges SummarizedExperiment  object ... generic, arguments pass specific methods. Unused now. dbsnp SNPlocs package, see available packages BSgenome::available.SNPs() chrom operate specified chromosome col_to_aggr column SNPlocs package add input. multiple SNPs overlap values concatenated comma separated values. drop TRUE, remove sites overlap SNPs genome BSgenome object, supplied, used provide additional \"snp_ref_allele\" \"snp_alt_alleles\" columns containing reference alt allele sequences, respect positive strand.","code":""},{"path":"https://rnabioco.github.io/raer/reference/annot_snps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate known SNP positions â€” annot_snps","text":"Either GRanges SummarizedExperiment object new column \"snp\" added information \"col_to_aggr\"","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/annot_snps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate known SNP positions â€” annot_snps","text":"","code":"if (require(SNPlocs.Hsapiens.dbSNP144.GRCh38)) {     gr <- GRanges(rep(\"22\", 10),         IRanges(             seq(10510077,                 10610077,                 by = 1000             )[1:10],             width = 250         ),         strand = \"+\"     )     genome(gr) <- \"GRCh38.p2\"     annot_snps(gr, SNPlocs.Hsapiens.dbSNP144.GRCh38) } #> Loading required package: SNPlocs.Hsapiens.dbSNP144.GRCh38 #> Loading required package: BSgenome #> Loading required package: Biostrings #> Loading required package: XVector #>  #> Attaching package: â€˜Biostringsâ€™ #> The following object is masked from â€˜package:baseâ€™: #>  #>     strsplit #> Loading required package: rtracklayer #> Warning: replacing previous import â€˜utils::findMatchesâ€™ by â€˜S4Vectors::findMatchesâ€™ when loading â€˜SNPlocs.Hsapiens.dbSNP144.GRCh38â€™ #> GRanges object with 10 ranges and 1 metadata column: #>        seqnames            ranges strand |   RefSNP_id #>           <Rle>         <IRanges>  <Rle> | <character> #>    [1]       22 10510077-10510326      + |             #>    [2]       22 10511077-10511326      + |   rs4022986 #>    [3]       22 10512077-10512326      + |             #>    [4]       22 10513077-10513326      + |             #>    [5]       22 10514077-10514326      + |             #>    [6]       22 10515077-10515326      + |             #>    [7]       22 10516077-10516326      + |             #>    [8]       22 10517077-10517326      + |             #>    [9]       22 10518077-10518326      + |             #>   [10]       22 10519077-10519326      + |             #>   ------- #>   seqinfo: 1 sequence from GRCh38.p2 genome; no seqlengths"},{"path":"https://rnabioco.github.io/raer/reference/calc_AEI.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","title":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","text":"Adenosine Editing Index describes magnitude --editing sample. index weighted average editing events (G bases) observed positions. vast majority --editing occurs ALU elements human genome, regions high --editing signal compared regions coding exons. function perform pileup specified repeat regions return summary AEI metric.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_AEI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","text":"","code":"calc_AEI(   bam_fn,   fasta_fn,   alu_ranges = NULL,   txdb = NULL,   snp_db = NULL,   param = FilterParam(),   BPPARAM = SerialParam(),   verbose = FALSE )"},{"path":"https://rnabioco.github.io/raer/reference/calc_AEI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","text":"bam_fn bam file fasta_fn fasta alu_ranges GRanges regions query calculating AEI, typically ALU repeats. txdb txdb object, supplied, used subset alu_ranges found overlapping genes. Alternatively GRanges object gene coordinates. snp_db either SNPlocs package, GPos, GRanges object. supplied, used exclude polymorphic positions prior calculating AEI. calc_AEI() used many times, one save time first identifying SNPs overlap supplied alu_ranges, passing GRanges snp_db rather supplying known SNPs (see get_overlapping_snps()). param object class FilterParam() specify various filters apply reads sites pileup. BPPARAM BiocParallelParam object specifying parallel options operating chromosomes. verbose report progress chromosome?","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_AEI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","text":"named list AEI index computed allelic combinations. correctly computed signal A_G index higher alleles (T_C), likely derived noise polymorphisms.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_AEI.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","text":"Roth, S.H., Levanon, E.Y. & Eisenberg, E. Genome-wide quantification ADAR adenosine--inosine RNA editing activity. Nat Methods 16, 1131â€“1138 (2019). https://doi.org/10.1038/s41592-019-0610-9","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_AEI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the Adenosine Editing Index (AEI) â€” calc_AEI","text":"","code":"suppressPackageStartupMessages(library(Rsamtools)) bamfn <- raer_example(\"SRR5564277_Aligned.sortedByCoord.out.md.bam\") fafn <- raer_example(\"human.fasta\") dummy_alu_ranges <- scanFaIndex(fafn) calc_AEI(bamfn, fafn, dummy_alu_ranges) #> $A_C #> [1] 0 #>  #> $A_G #> [1] 2.298586 #>  #> $A_T #> [1] 0.1292293 #>  #> $C_A #> [1] 0.2142033 #>  #> $C_G #> [1] 0.01650982 #>  #> $C_T #> [1] 0.2635046 #>  #> $G_A #> [1] 0.3170769 #>  #> $G_C #> [1] 0 #>  #> $G_T #> [1] 0 #>  #> $T_A #> [1] 0 #>  #> $T_C #> [1] 0.0116198 #>  #> $T_G #> [1] 0.0116198 #>"},{"path":"https://rnabioco.github.io/raer/reference/calc_confidence.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate confidence score for observing editing â€” calc_confidence","title":"Calculate confidence score for observing editing â€” calc_confidence","text":"Calculate confidence score based Bayesian inverse probability model described Washburn et al. Cell Reports. 2015, implemented SAILOR pipeline.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_confidence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate confidence score for observing editing â€” calc_confidence","text":"","code":"calc_confidence(   se,   edit_to = \"G\",   edit_from = \"A\",   per_sample = FALSE,   exp_fraction = 0.01 )"},{"path":"https://rnabioco.github.io/raer/reference/calc_confidence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate confidence score for observing editing â€” calc_confidence","text":"se SummarizedExperiment::SummarizedExperiment containing editing sites edit_to edited base edit_from non-edited base per_sample TRUE, calculate confidence per sample, otherwise edited non-edited counts summed across samples. exp_fraction Numeric, confidence margin parameter ","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_confidence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate confidence score for observing editing â€” calc_confidence","text":"SummarizedExperiment::SummarizedExperiment either new assay rowData column named \"confidence\" depending whether confidence calculated per_sample.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_confidence.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate confidence score for observing editing â€” calc_confidence","text":"Washburn MC, Kakaradov B, Sundararaman B, Wheeler E, Hoon S, Yeo GW, Hundley HA. dsRBP inactive editor ADR-1 utilizes dsRNA binding regulate --RNA editing across C. elegans transcriptome. Cell Rep. 2014 Feb 27;6(4):599-607. doi: 10.1016/j.celrep.2014.01.011. Epub 2014 Feb 6. PMID: 24508457; PMCID: PMC3959997. SAILOR pipeline: https://github.com/YeoLab/sailor","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_confidence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate confidence score for observing editing â€” calc_confidence","text":"","code":"data(rse_adar_ifn) calc_confidence(rse_adar_ifn) #> class: RangedSummarizedExperiment  #> dim: 74 2  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(74): SSR3_102_- SSR3_125_- ... DHFR_430_- DHFR_513_- #> rowData names(5): REF rbpz vpb sor confidence #> colnames(2): wt adar1_ko #> colData names(1): sample calc_confidence(rse_adar_ifn, per_sample = TRUE) #> class: RangedSummarizedExperiment  #> dim: 74 2  #> metadata(0): #> assays(8): ALT nRef ... nG confidence #> rownames(74): SSR3_102_- SSR3_125_- ... DHFR_430_- DHFR_513_- #> rowData names(4): REF rbpz vpb sor #> colnames(2): wt adar1_ko #> colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/calc_edit_frequency.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds editing frequencies â€” calc_edit_frequency","title":"Adds editing frequencies â€” calc_edit_frequency","text":"Adds editing frequencies existing SummarizedExperiment object (created merge_pileups). SummarizedExperiment new assay editing frequencies site (edit_freq), depth coverage computed using indicatededited nucleotides (depth`) new colData columns number edited sites (n_sites) fraction edits (edit_idx) returned.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_edit_frequency.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds editing frequencies â€” calc_edit_frequency","text":"","code":"calc_edit_frequency(   se,   edit_from = NULL,   edit_to = NULL,   drop = FALSE,   replace_na = TRUE,   edit_frequency = 0,   min_count = 1 )"},{"path":"https://rnabioco.github.io/raer/reference/calc_edit_frequency.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds editing frequencies â€” calc_edit_frequency","text":"se SummarizedExperiment object created merge_pileups edit_from nucleotide (, C, G, T) corresponding nucleotide expect reference. Ex. editing events, \"\". NULL, editing frequencies calculated using nAlt nRef values. edit_to nucleotide (, C, G, T) correspond nucleotide expect editing event. Ex. editing events, \"G\". NULL, editing frequencies calculated using nAlt nRef values. drop TRUE, summarizedExperiment returned retain sites matching specified edit_from edit_to bases. replace_na TRUE, NA NaN editing frequencies coerced 0. edit_frequency edit frequency cutoff used calculating number sites. Set 0 require non-zero editing frequency. number sites stored n_sites colData. min_count minimum number reads required enumerating number editing sites detected.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_edit_frequency.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adds editing frequencies â€” calc_edit_frequency","text":"SummarizedExperiment::SummarizedExperiment supplemented edit_freq assay.","code":""},{"path":"https://rnabioco.github.io/raer/reference/calc_edit_frequency.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adds editing frequencies â€” calc_edit_frequency","text":"","code":"library(SummarizedExperiment) data(rse_adar_ifn) rse <- calc_edit_frequency(rse_adar_ifn) assay(rse, \"edit_freq\")[1:5, ] #>                    wt   adar1_ko #> SSR3_102_- 0.00000000 0.07692308 #> SSR3_125_- 0.04545455 0.00000000 #> SSR3_156_- 0.03846154 0.00000000 #> SSR3_176_- 0.66666667 0.00000000 #> SSR3_198_- 0.04000000 0.00000000"},{"path":"https://rnabioco.github.io/raer/reference/correct_strand.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply strand correction using gene annotations â€” correct_strand","title":"Apply strand correction using gene annotations â€” correct_strand","text":"Gene annotations used infer likely strand editing sites. function operate unstranded datasets processed using \"genomic-unstranded\" library type reports variants respect + strand sites. strand editing site assigned strand overlapping features genes_gr object. Sites -overlap, overlapping features conflicting strands (+ -) removed.","code":""},{"path":"https://rnabioco.github.io/raer/reference/correct_strand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply strand correction using gene annotations â€” correct_strand","text":"","code":"correct_strand(rse, genes_gr)"},{"path":"https://rnabioco.github.io/raer/reference/correct_strand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply strand correction using gene annotations â€” correct_strand","text":"rse RangedSummarizedExperiment object containing editing sites processed \"genomic-unstranded\" setting genes_gr GRanges object containing reference features annotate strand editing sites.","code":""},{"path":"https://rnabioco.github.io/raer/reference/correct_strand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply strand correction using gene annotations â€” correct_strand","text":"RangedSummarizedExperiment object containing pileup assays, strand corrected based supplied genomic intervals.","code":""},{"path":"https://rnabioco.github.io/raer/reference/correct_strand.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Apply strand correction using gene annotations â€” correct_strand","text":"","code":"suppressPackageStartupMessages(library(\"GenomicRanges\"))  bamfn <- raer_example(\"SRR5564269_Aligned.sortedByCoord.out.md.bam\") fafn <- raer_example(\"human.fasta\") fp <- FilterParam(library_type = \"genomic-unstranded\") rse <- pileup_sites(bamfn, fafn, param = fp)  genes <- GRanges(c(     \"DHFR:200-400:+\",     \"SPCS3:100-200:-\",     \"SSR3:3-10:-\",     \"SSR3:6-12:+\" ))  correct_strand(rse, genes) #> class: RangedSummarizedExperiment  #> dim: 307 1  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(307): SSR3-3-+ SSR3-4-+ ... DHFR-399-+ DHFR-400-+ #> rowData names(4): REF rbpz vpb sor #> colnames(1): SRR5564269_Aligned.sortedByCoord.out.md.bam #> colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/download_GSE99249.html","id":null,"dir":"Reference","previous_headings":"","what":"Download GSE99249 BAM files and related data â€” download_GSE99249","title":"Download GSE99249 BAM files and related data â€” download_GSE99249","text":"function download ~ 250 MB data store files BiocFileCache.","code":""},{"path":"https://rnabioco.github.io/raer/reference/download_GSE99249.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download GSE99249 BAM files and related data â€” download_GSE99249","text":"","code":"download_GSE99249(verbose = TRUE)"},{"path":"https://rnabioco.github.io/raer/reference/download_GSE99249.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download GSE99249 BAM files and related data â€” download_GSE99249","text":"verbose report messages","code":""},{"path":"https://rnabioco.github.io/raer/reference/download_GSE99249.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download GSE99249 BAM files and related data â€” download_GSE99249","text":"named list paths BAM files, FASTA file bed file known editing sites hg38 chromosome 18.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/download_GSE99249.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download GSE99249 BAM files and related data â€” download_GSE99249","text":"","code":"# \\donttest{ download_GSE99249() #> $bams #> [1] \"/github/home/.cache/R/raer/SRR5564260_dedup_sorted.bam\" #> [2] \"/github/home/.cache/R/raer/SRR5564261_dedup_sorted.bam\" #> [3] \"/github/home/.cache/R/raer/SRR5564269_dedup_sorted.bam\" #> [4] \"/github/home/.cache/R/raer/SRR5564270_dedup_sorted.bam\" #> [5] \"/github/home/.cache/R/raer/SRR5564271_dedup_sorted.bam\" #> [6] \"/github/home/.cache/R/raer/SRR5564277_dedup_sorted.bam\" #>  #> $bai #> [1] \"/github/home/.cache/R/raer/SRR5564260_dedup_sorted.bam.bai\" #> [2] \"/github/home/.cache/R/raer/SRR5564261_dedup_sorted.bam.bai\" #> [3] \"/github/home/.cache/R/raer/SRR5564269_dedup_sorted.bam.bai\" #> [4] \"/github/home/.cache/R/raer/SRR5564270_dedup_sorted.bam.bai\" #> [5] \"/github/home/.cache/R/raer/SRR5564271_dedup_sorted.bam.bai\" #> [6] \"/github/home/.cache/R/raer/SRR5564277_dedup_sorted.bam.bai\" #>  #> $fasta #> [1] \"/github/home/.cache/R/raer/5c96c36be13_chr18.fasta.bgz\" #>  #> $bed #> [1] \"/github/home/.cache/R/raer/5c93d3d2742_rediportal_hg38_chr18.bed.gz\" #>  # }"},{"path":"https://rnabioco.github.io/raer/reference/download_NA12878.html","id":null,"dir":"Reference","previous_headings":"","what":"Download NA12878 BAM files and related data â€” download_NA12878","title":"Download NA12878 BAM files and related data â€” download_NA12878","text":"function download ~100MB data store files BiocFileCache.","code":""},{"path":"https://rnabioco.github.io/raer/reference/download_NA12878.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download NA12878 BAM files and related data â€” download_NA12878","text":"","code":"download_NA12878(verbose = TRUE)"},{"path":"https://rnabioco.github.io/raer/reference/download_NA12878.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download NA12878 BAM files and related data â€” download_NA12878","text":"verbose report messages","code":""},{"path":"https://rnabioco.github.io/raer/reference/download_NA12878.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download NA12878 BAM files and related data â€” download_NA12878","text":"named list paths RNA-seq WGS BAM file, FASTA file hg38 chromosome 4.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/download_NA12878.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download NA12878 BAM files and related data â€” download_NA12878","text":"","code":"# \\donttest{ download_NA12878() #> $bams #> [1] \"/github/home/.cache/R/raer/ERR262996_dedup_chr4_sub.bam\"            #> [2] \"/github/home/.cache/R/raer/SRR1258218_Aligned.sorted.dedup_sub.bam\" #>  #> $bai #> [1] \"/github/home/.cache/R/raer/ERR262996_dedup_chr4_sub.bam.bai\"            #> [2] \"/github/home/.cache/R/raer/SRR1258218_Aligned.sorted.dedup_sub.bam.bai\" #>  #> $fasta #> [1] \"/github/home/.cache/R/raer/5c910363ec3_hg38_chr4.fa.bgz\" #>  #> $snps #> [1] \"/github/home/.cache/R/raer/5c95cfbb0a6_chr4snps.bed.gz\" #>  #> $rmsk #> [1] \"/github/home/.cache/R/raer/5c9224a4ef2_rmsk_hg38.tsv.gz\" #>  # }"},{"path":"https://rnabioco.github.io/raer/reference/download_human_pbmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Download 10x PMBC bam file and related data â€” download_human_pbmc","title":"Download 10x PMBC bam file and related data â€” download_human_pbmc","text":"function download < 1 GB data store files BiocFileCache.","code":""},{"path":"https://rnabioco.github.io/raer/reference/download_human_pbmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download 10x PMBC bam file and related data â€” download_human_pbmc","text":"","code":"download_human_pbmc(verbose = TRUE)"},{"path":"https://rnabioco.github.io/raer/reference/download_human_pbmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download 10x PMBC bam file and related data â€” download_human_pbmc","text":"verbose report messages","code":""},{"path":"https://rnabioco.github.io/raer/reference/download_human_pbmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download 10x PMBC bam file and related data â€” download_human_pbmc","text":"named list paths bam file, fasta file, bed file editing_sites, .rds file SingleCellExperiment","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/download_human_pbmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download 10x PMBC bam file and related data â€” download_human_pbmc","text":"","code":"# \\donttest{ download_human_pbmc() #> $bam #> [1] \"/github/home/.cache/R/raer/10k_PBMC_3p_nextgem_Chromium_X_intron_possorted_chr16_rp.bam\" #>  #> $bai #> [1] \"/github/home/.cache/R/raer/10k_PBMC_3p_nextgem_Chromium_X_intron_possorted_chr16_rp.bam.bai\" #>  #> $edit_sites #> [1] \"/github/home/.cache/R/raer/5c940f65ed3_rediportal_chr16.bed.gz\" #>  #> $sce #> [1] \"/github/home/.cache/R/raer/5c932f56b89_sce.rds\" #>  # }"},{"path":"https://rnabioco.github.io/raer/reference/filter_clustered_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter out clustered sequence variants â€” filter_clustered_variants","title":"Filter out clustered sequence variants â€” filter_clustered_variants","text":"Sequence variants multiple allele types (e.g., >G, >C) nearby regions can due mis-alignment. Remove variants multiple allele types present within given distance genomic transcriptome coordinate space.","code":""},{"path":"https://rnabioco.github.io/raer/reference/filter_clustered_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter out clustered sequence variants â€” filter_clustered_variants","text":"","code":"filter_clustered_variants(   rse,   txdb,   regions = c(\"transcript\", \"genome\"),   variant_dist = 100 )"},{"path":"https://rnabioco.github.io/raer/reference/filter_clustered_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter out clustered sequence variants â€” filter_clustered_variants","text":"rse SummarizedExperiment::SummarizedExperiment containing editing sites txdb GenomicFeatures::TxDb regions One transcript genome, specifying coordinate system calculating distances variants. variant_dist distance nucleotides determining clustered variants","code":""},{"path":"https://rnabioco.github.io/raer/reference/filter_clustered_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter out clustered sequence variants â€” filter_clustered_variants","text":"SummarizedExperiment::SummarizedExperiment sites removed object dependent filtering applied.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/filter_clustered_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter out clustered sequence variants â€” filter_clustered_variants","text":"","code":"if (require(TxDb.Hsapiens.UCSC.hg38.knownGene)) {     data(rse_adar_ifn)     gr <- GRanges(c(\"DHFR:310-330:-\",                     \"DHFR:410-415:-\",                     \"SSR3:100-155:-\",                     \"SSR3:180-190:-\"))     gr$source <- \"raer\"     gr$type <- \"exon\"     gr$source <- NA     gr$phase <- NA_integer_     gr$gene_id <- c(1,1,2,2)     gr$transcript_id <- rep(c(\"1.1\",\"2.1\"), each = 2)     txdb <- makeTxDbFromGRanges(gr)      rse <- filter_multiallelic(rse_adar_ifn)      filter_clustered_variants(rse, txdb) } #> Loading required package: TxDb.Hsapiens.UCSC.hg38.knownGene #> Loading required package: GenomicFeatures #> Loading required package: AnnotationDbi #> â„¹ `filter_multiallelic()`: removed 2 sites from 74 (72 remain) #> â„¹ `filter_clustered_variants()`: removed 70 sites from 72 (2 remain) #> class: RangedSummarizedExperiment  #> dim: 2 2  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(2): SSR3_502_- SPCS3_99_+ #> rowData names(5): REF rbpz vpb sor ALT #> colnames(2): wt adar1_ko #> colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/filter_multiallelic.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter out multi-allelic sites â€” filter_multiallelic","title":"Filter out multi-allelic sites â€” filter_multiallelic","text":"Remove sites multiple variant bases SummarizedExperiment. rowData() gains new column, ALT, contains variant allele detected site.","code":""},{"path":"https://rnabioco.github.io/raer/reference/filter_multiallelic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter out multi-allelic sites â€” filter_multiallelic","text":"","code":"filter_multiallelic(se)"},{"path":"https://rnabioco.github.io/raer/reference/filter_multiallelic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter out multi-allelic sites â€” filter_multiallelic","text":"se SummarizedExperiment::SummarizedExperiment","code":""},{"path":"https://rnabioco.github.io/raer/reference/filter_multiallelic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter out multi-allelic sites â€” filter_multiallelic","text":"SummarizedExperiment::SummarizedExperiment multiallelic sites removed.  new column,ALT added rowData() indicating single allele present site.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/filter_multiallelic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter out multi-allelic sites â€” filter_multiallelic","text":"","code":"data(rse_adar_ifn) filter_multiallelic(rse_adar_ifn) #> â„¹ `filter_multiallelic()`: removed 2 sites from 74 (72 remain) #> class: RangedSummarizedExperiment  #> dim: 72 2  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(72): SSR3_102_- SSR3_125_- ... DHFR_430_- DHFR_513_- #> rowData names(5): REF rbpz vpb sor ALT #> colnames(2): wt adar1_ko #> colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/filter_splice_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter out sites near splice sites â€” filter_splice_variants","title":"Filter out sites near splice sites â€” filter_splice_variants","text":"Remove editing sites found regions proximal annotated splice junctions.","code":""},{"path":"https://rnabioco.github.io/raer/reference/filter_splice_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter out sites near splice sites â€” filter_splice_variants","text":"","code":"filter_splice_variants(rse, txdb, splice_site_dist = 4, ignore.strand = FALSE)"},{"path":"https://rnabioco.github.io/raer/reference/filter_splice_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter out sites near splice sites â€” filter_splice_variants","text":"rse SummarizedExperiment::SummarizedExperiment editing sites txdb GenomicFeatures::TxDb splice_site_dist distance splice site ignore.strand TRUE, ignore strand comparing editing sites splice sites","code":""},{"path":"https://rnabioco.github.io/raer/reference/filter_splice_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter out sites near splice sites â€” filter_splice_variants","text":"SummarizedExperiment::SummarizedExperiment sites adjacent splice sites removed.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/filter_splice_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter out sites near splice sites â€” filter_splice_variants","text":"","code":"if (require(TxDb.Hsapiens.UCSC.hg38.knownGene)) {     data(rse_adar_ifn)     gr <- GRanges(c(\"DHFR:310-330:-\",                     \"DHFR:410-415:-\",                     \"SSR3:100-155:-\",                     \"SSR3:180-190:-\"))     gr$source <- \"raer\"     gr$type <- \"exon\"     gr$source <- NA     gr$phase <- NA_integer_     gr$gene_id <- c(1,1,2,2)     gr$transcript_id <- rep(c(\"1.1\",\"2.1\"), each = 2)     txdb <- makeTxDbFromGRanges(gr)     filter_splice_variants(rse_adar_ifn, txdb) } #> â„¹ `filter_splice_variants()`: removed 5 sites from 74 (69 remain) #> class: RangedSummarizedExperiment  #> dim: 69 2  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(69): SSR3_102_- SSR3_125_- ... DHFR_430_- DHFR_513_- #> rowData names(4): REF rbpz vpb sor #> colnames(2): wt adar1_ko #> colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/get_overlapping_snps.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve SNPs overlapping intervals â€” get_overlapping_snps","title":"Retrieve SNPs overlapping intervals â€” get_overlapping_snps","text":"function find SNPs overlapping supplied intervals using SNPlocs package. SNPs can returned memory (GPos objects) written disk bed-file (optionally compressed).","code":""},{"path":"https://rnabioco.github.io/raer/reference/get_overlapping_snps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve SNPs overlapping intervals â€” get_overlapping_snps","text":"","code":"get_overlapping_snps(gr, snpDb, output_file = NULL)"},{"path":"https://rnabioco.github.io/raer/reference/get_overlapping_snps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve SNPs overlapping intervals â€” get_overlapping_snps","text":"gr Intervals query snpDb reference ot SNPlocs database output_file path output file. supplied file can optionally compressed including \".gz\" suffix. supplied, SNPS returned GenomicRanges::GPos object","code":""},{"path":"https://rnabioco.github.io/raer/reference/get_overlapping_snps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve SNPs overlapping intervals â€” get_overlapping_snps","text":"GPos object containing SNPs overlapping supplied genomic intervals","code":""},{"path":"https://rnabioco.github.io/raer/reference/get_overlapping_snps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve SNPs overlapping intervals â€” get_overlapping_snps","text":"","code":"if (require(SNPlocs.Hsapiens.dbSNP144.GRCh38)) {     gr <- GRanges(rep(\"22\", 10),         IRanges(seq(10510077, 10610077, by = 1000)[1:10], width = 250),         strand = \"+\"     )     get_overlapping_snps(gr, SNPlocs.Hsapiens.dbSNP144.GRCh38) } #> UnstitchedGPos object with 1 position and 0 metadata columns: #>       seqnames       pos strand #>          <Rle> <integer>  <Rle> #>   [1]       22  10511116      * #>   ------- #>   seqinfo: 25 sequences (1 circular) from GRCh38.p2 genome"},{"path":"https://rnabioco.github.io/raer/reference/get_splice_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract regions surrounding splice sites â€” get_splice_sites","title":"Extract regions surrounding splice sites â€” get_splice_sites","text":"Find intervals containing splice sites adjacent regions.","code":""},{"path":"https://rnabioco.github.io/raer/reference/get_splice_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract regions surrounding splice sites â€” get_splice_sites","text":"","code":"get_splice_sites(txdb, slop = 4)"},{"path":"https://rnabioco.github.io/raer/reference/get_splice_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract regions surrounding splice sites â€” get_splice_sites","text":"txdb GenomicFeatures::TxDb slop number bases upstream downstream splice site extract","code":""},{"path":"https://rnabioco.github.io/raer/reference/get_splice_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract regions surrounding splice sites â€” get_splice_sites","text":"GenomicRanges::GRanges containing positions splice sites, flanking bases.","code":""},{"path":"https://rnabioco.github.io/raer/reference/get_splice_sites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract regions surrounding splice sites â€” get_splice_sites","text":"","code":"if (require(TxDb.Hsapiens.UCSC.hg38.knownGene)) {     txdb <- TxDb.Hsapiens.UCSC.hg38.knownGene     res <- get_splice_sites(txdb)     res[1:5] } #> GRanges object with 5 ranges and 0 metadata columns: #>       seqnames      ranges strand #>          <Rle>   <IRanges>  <Rle> #>   [1]     chr1 12054-12061      + #>   [2]     chr1 12175-12182      + #>   [3]     chr1 12224-12231      + #>   [4]     chr1 12224-12231      + #>   [5]     chr1 12609-12616      + #>   ------- #>   seqinfo: 711 sequences from an unspecified genome; no seqlengths"},{"path":"https://rnabioco.github.io/raer/reference/merge_pileups.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge pileups into a RangedSummarizedExperiment â€” merge_pileups","title":"Merge pileups into a RangedSummarizedExperiment â€” merge_pileups","text":"Create RangedSummarizedExperiment single list pileups (e.g., different samples) generated pileup_sites().","code":""},{"path":"https://rnabioco.github.io/raer/reference/merge_pileups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge pileups into a RangedSummarizedExperiment â€” merge_pileups","text":"","code":"merge_pileups(   plps,   assay_cols = c(\"ALT\", \"nRef\", \"nAlt\", \"nA\", \"nT\", \"nC\", \"nG\"),   sample_names = NULL,   fill_na = NULL,   verbose = FALSE )"},{"path":"https://rnabioco.github.io/raer/reference/merge_pileups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge pileups into a RangedSummarizedExperiment â€” merge_pileups","text":"plps results running pileup_sites(), can one result, list results, named list results. named list given, colData named using names list. assay_cols character vector columns store assays sample_names list names added SE object. sample names given plps named list, default names (ie sample_1, sample_2, ..., sample_n) given warning printed. fill_na Numeric value replace NAs numeric matrices used plps computed independently min_nucleotide_count = 1, otherwise sites may set 0, although may coverage > 0 less min_nucleotide_count parameter. verbose print information progress","code":""},{"path":"https://rnabioco.github.io/raer/reference/merge_pileups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge pileups into a RangedSummarizedExperiment â€” merge_pileups","text":"RangedSummarizedExperiment populated assays specified assay_cols.","code":""},{"path":"https://rnabioco.github.io/raer/reference/perform_de.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform differential editing â€” perform_de","title":"Perform differential editing â€” perform_de","text":"Uses either edgeR DESeq2 perform differential editing analysis. work simple designs 1 treatment 1 control. complex designs, suggest perform . moment, function find editing events specific treatment, pretty straight forward add possible return values.","code":""},{"path":"https://rnabioco.github.io/raer/reference/perform_de.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform differential editing â€” perform_de","text":"","code":"perform_de(   deobj,   type = \"edgeR\",   sample_col = \"sample\",   condition_col = \"condition\",   condition_control = NULL,   condition_treatment = NULL )"},{"path":"https://rnabioco.github.io/raer/reference/perform_de.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform differential editing â€” perform_de","text":"deobj SummarizedExperiment object prepared de prep_for_de type OPTIONAL edgeR DESeq run. Default edgeR sample_col OPTIONAL name column colData(deobj) contains sample information. Default sample. column named \"sample\", must provide appropriate sample column condition_col OPTIONAL name column colData(deobj) contains treatment information. Default condition, column named \"condition\", must provide appropriate condition column condition_control name control condition. must variable condition_col colData(deobj). default provided. condition_treatment name treatment condition. must variable condition_col colData(deobj).","code":""},{"path":"https://rnabioco.github.io/raer/reference/perform_de.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform differential editing â€” perform_de","text":"named list - de_obj: edgeR deseq object used differential editing analysis - results_full: Unfiltered differenital editing results - sig_results: Filtered differenial editing (FDR < 0.05) - model_matrix: model matrix used generating DE results","code":""},{"path":"https://rnabioco.github.io/raer/reference/perform_de.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform differential editing â€” perform_de","text":"","code":"library(SummarizedExperiment) bamfn <- raer_example(\"SRR5564269_Aligned.sortedByCoord.out.md.bam\") bam2fn <- raer_example(\"SRR5564277_Aligned.sortedByCoord.out.md.bam\") fafn <- raer_example(\"human.fasta\")  bams <- rep(c(bamfn, bam2fn), each = 3) sample_ids <- paste0(rep(c(\"KO\", \"WT\"), each = 3), 1:3) names(bams) <- sample_ids  fp <- FilterParam(only_keep_variants = TRUE) rse <- pileup_sites(bams, fafn, param = fp) rse$condition <- substr(rse$sample, 1, 2)  rse <- calc_edit_frequency(rse) dse <- prep_for_de(rse) res <- perform_de(dse, condition_control = \"WT\", condition_treatment = \"KO\") #> Using classic mode. res$sig_results[1:5, ] #>                 logFC   logCPM        LR       PValue         FDR #> DHFR-361-- -11.147610 21.96719 13.393676 0.0002524741 0.006816801 #> SSR3-176--  -8.000087 21.19460 11.166011 0.0008330957 0.011246792 #> SSR3-364--  -5.600787 19.69710  9.086110 0.0025755817 0.016444635 #> DHFR-260--  -8.108926 22.26785  8.548454 0.0034581581 0.016444635 #> SSR3-290--  -4.839287 20.65403  8.454728 0.0036409569 0.016444635"},{"path":"https://rnabioco.github.io/raer/reference/pileup_cells.html","id":null,"dir":"Reference","previous_headings":"","what":"Pileup sites per cell â€” pileup_cells","title":"Pileup sites per cell â€” pileup_cells","text":"function performs pileup operation specified sites, returning counts Reference (e.g. unedited) Alternate (e.g. edited) bases. pileup_cells can process either 10x Genomic's style library, aligned bam file containing tag cell-barcode tag UMI, smart-seq style libraries without cell-barcodes. sites parameter specifies sites pileup. must GRanges object 1 base intervals, strand (+ -), supplemented metadata columns named REF ALT containing reference alternate base query. See examples example format. site, bases overlapping reads examined, counts ref alt base enumerated cell-barcode present. single base counted UMI sequence present cell.","code":""},{"path":"https://rnabioco.github.io/raer/reference/pileup_cells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pileup sites per cell â€” pileup_cells","text":"","code":"pileup_cells(   bamfile,   sites,   cell_barcodes,   output_directory,   chroms = NULL,   umi_tag = \"UB\",   cb_tag = \"CB\",   paired_end = FALSE,   param = FilterParam(),   BPPARAM = SerialParam(),   return_sce = TRUE,   verbose = FALSE )"},{"path":"https://rnabioco.github.io/raer/reference/pileup_cells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pileup sites per cell â€” pileup_cells","text":"bamfile BAM file name (10x libraries), vector bam file names (smart-seq2) sites GRanges object containing sites process. See examples valid formatting. cell_barcodes character vector single cell barcodes process. output_directory Output directory output files. generated exist. chroms character vector chromosomes process, supplied, sites present listed chromosomes processed umi_tag tag bam containing UMI sequence cb_tag tag bam containing cell-barcode sequence paired_end set TRUE data paired-end prevent double counting overlapping read pairs. param object class FilterParam() specify various filters apply reads sites pileup. Note min_variant_reads parameter, set > 0, specifies number variant reads site required order report site. E.g. set 2, least 2 reads (cell) must variant order report site. default 0 reports sites present sites object. BPPARAM BiocParallel instance. Parallel computation occurs across chromosomes. return_sce TRUE, data returned SingleCellExperiment, FALSE character vector output files, specified outfile_prefix, returned. verbose Display messages","code":""},{"path":"https://rnabioco.github.io/raer/reference/pileup_cells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pileup sites per cell â€” pileup_cells","text":"Returns either SingleCellExperiment character vector paths files produced.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/pileup_cells.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pileup sites per cell â€” pileup_cells","text":"","code":"library(Rsamtools) library(GenomicRanges) bam_fn <- raer_example(\"5k_neuron_mouse_possort.bam\")  gr <- GRanges(c(\"2:579:-\", \"2:625:-\", \"2:645:-\", \"2:589:-\", \"2:601:-\")) gr$REF <- c(rep(\"A\", 4), \"T\") gr$ALT <- c(rep(\"G\", 4), \"C\")  cbs <- unique(scanBam(bam_fn, param = ScanBamParam(tag = \"CB\"))[[1]]$tag$CB) cbs <- na.omit(cbs)  outdir <- tempdir() bai <- indexBam(bam_fn) on.exit(unlink(c(outdir, bai)))  fp <- FilterParam(library_type = \"fr-second-strand\") sce <- pileup_cells(bam_fn, gr, cbs, outdir, param = fp) #> Error: BiocParallel errors #>   1 remote errors, element index: 1 #>   0 unevaluated and other errors #>   first remote error: #> Error in (function (bamfn, id, sites, barcodes, outfile_prefix, chrom, : [raer interal] fail to load bamfile index for /__w/_temp/Library/raer/extdata/5k_neuron_mouse_possort.bam #>  sce #> Error in eval(expr, envir, enclos): object 'sce' not found  # example of processing multiple smart-seq2 style libraries  many_small_bams <- rep(bam_fn, 10) bam_ids <- LETTERS[1:10] pileup_cells(many_small_bams,     sites = gr,     cell_barcodes = bam_ids,     cb_tag = NULL,     umi_tag = NULL,     paired_end = TRUE,     outdir,     param = fp ) #> class: SingleCellExperiment  #> dim: 5 10  #> metadata(0): #> assays(2): nRef nAlt #> rownames(5): 2:579_2_A_G 2:625_2_A_G 2:645_2_A_G 2:589_2_A_G #>   2:601_2_T_C #> rowData names(2): ref alt #> colnames(10): A B ... I J #> colData names(1): id #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"},{"path":"https://rnabioco.github.io/raer/reference/pileup_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate base counts using pileup â€” pileup_sites","title":"Generate base counts using pileup â€” pileup_sites","text":"Generate base counts using pileup","code":""},{"path":"https://rnabioco.github.io/raer/reference/pileup_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate base counts using pileup â€” pileup_sites","text":"","code":"pileup_sites(   bamfiles,   fafile,   sites = NULL,   region = NULL,   chroms = NULL,   param = FilterParam(),   outfile_prefix = NULL,   reads = NULL,   return_data = TRUE,   BPPARAM = SerialParam(),   bad_reads = NULL,   umi_tag = NULL,   verbose = FALSE )  FilterParam(   max_depth = 10000,   min_depth = 1L,   min_base_quality = 20L,   min_mapq = 0L,   library_type = \"fr-first-strand\",   bam_flags = NULL,   only_keep_variants = FALSE,   trim_5p = 0L,   trim_3p = 0L,   ftrim_5p = 0,   ftrim_3p = 0,   indel_dist = 0L,   splice_dist = 0L,   min_splice_overhang = 0L,   homopolymer_len = 0L,   max_mismatch_type = c(0L, 0L),   read_bqual = c(0, 0),   min_variant_reads = 0L,   min_allelic_freq = 0,   report_multiallelic = TRUE )"},{"path":"https://rnabioco.github.io/raer/reference/pileup_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate base counts using pileup â€” pileup_sites","text":"bamfiles character vector paths 1 bam files. named, names included colData RangedSummarizedExperiment, otherwise colData populated basename bamfile. fafile path fasta file sites GRanges object containing regions sites process. region samtools region query string (.e. chr1:100-1000). Can combined sites, case sites filtered keep sites within region. chroms chromosomes process, used region. param object class FilterParam() specify various filters apply reads sites pileup. outfile_prefix Output prefix tabix indexed files. NULL, files produced. reads supplied fasta file written reads pass filters contain variants return_data TRUE, data returned RangedSummarizedExperiment, FALSE character vector tabix-index files, specified outfile_prefix, returned. BPPARAM BiocParallel class control parallel execution. Parallel processing occurs per chromosome, disabled run single region. bad_reads textfile containing read names exclude pileup. Readnames formated readid_1 readid_2 readid paired end first read paired-end second read single end data. umi_tag bam tag containing UMI sequence. supplied, multiple reads UMI sequence counted per position. verbose TRUE, report progress warnings. max_depth maximum read depth considered site min_depth min read depth needed report site min_base_quality min base quality score consider read pileup min_mapq minimum required MAPQ score, can vector values bam file library_type read orientation, one fr-first-strand, fr-second-strand, unstranded, genomic-unstranded. Can supply vector specify input bam. Unstranded library type reported based read alignment. genomic-unstranded report variants w.r.t + strand. bam_flags bam flags filter keep, use Rsamtools::scanBamFlag() generate. only_keep_variants TRUE, variant sites reported (FALSE default), can vector input bamfile trim_5p Bases trim 5' end read alignments trim_3p Bases trim 3' end read alignments ftrim_5p Fraction bases trim 5' end read alignments ftrim_3p Fraction bases trim 3' end read alignments indel_dist Exclude read site occurs within given distance indel event read splice_dist Exclude read site occurs within given distance splicing event read min_splice_overhang Exclude read site located adjacent splice site overhang less given length. homopolymer_len Exclude site occurs within homopolymer given length max_mismatch_type Exclude read X different mismatch types (e.g --G, G--C, C--G, 3 mismatch types) Y # mismatches, must supplied integer vector length 2. e.g. c(X, Y). read_bqual Exclude read X percent bases base qualities less Y. Numeric vector length 2. e.g. c(0.25, 20) min_variant_reads Required number reads containing variant site reported. Calculated per bam file, 1 bam file >= min_variant_reads, site reported. min_allelic_freq minimum allelic frequency required variant reported ALT assays. report_multiallelic TRUE, report sites multiple variants passing filters. FALSE, site reported.","code":""},{"path":"https://rnabioco.github.io/raer/reference/pileup_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate base counts using pileup â€” pileup_sites","text":"RangedSummarizedExperiment vector output tabixed file names return_data FALSE.","code":""},{"path":"https://rnabioco.github.io/raer/reference/pileup_sites.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate base counts using pileup â€” pileup_sites","text":"Multiple bam files can processed together, files written bam file. mode output regions consistent across files. min_mapq, only_keep_variants, library_type parameters can specified input files.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/pileup_sites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate base counts using pileup â€” pileup_sites","text":"","code":"library(SummarizedExperiment) bamfn <- raer_example(\"SRR5564269_Aligned.sortedByCoord.out.md.bam\") bam2fn <- raer_example(\"SRR5564277_Aligned.sortedByCoord.out.md.bam\") fafn <- raer_example(\"human.fasta\")  rse <- pileup_sites(bamfn, fafn)  fp <- FilterParam(only_keep_variants = TRUE, min_depth = 55) pileup_sites(bamfn, fafn, param = fp) #> class: RangedSummarizedExperiment  #> dim: 7 1  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(7): DHFR-207-- DHFR-208-- ... DHFR-300-- DHFR-332-- #> rowData names(4): REF rbpz vpb sor #> colnames(1): SRR5564269_Aligned.sortedByCoord.out.md.bam #> colData names(1): sample   # using multiple bam files  bams <- rep(c(bamfn, bam2fn), each = 3) sample_ids <- paste0(rep(c(\"KO\", \"WT\"), each = 3), 1:3) names(bams) <- sample_ids  fp <- FilterParam(only_keep_variants = TRUE) rse <- pileup_sites(bams, fafn, param = fp) rse #> class: RangedSummarizedExperiment  #> dim: 74 6  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(74): SSR3-102-- SSR3-125-- ... DHFR-430-- DHFR-513-- #> rowData names(4): REF rbpz vpb sor #> colnames(6): KO1 KO2 ... WT2 WT3 #> colData names(1): sample  rse$condition <- substr(rse$sample, 1, 2) assays(rse) #> List of length 7 #> names(7): ALT nRef nAlt nA nT nC nG  colData(rse) #> DataFrame with 6 rows and 2 columns #>          sample   condition #>     <character> <character> #> KO1         KO1          KO #> KO2         KO2          KO #> KO3         KO3          KO #> WT1         WT1          WT #> WT2         WT2          WT #> WT3         WT3          WT  rowRanges(rse) #> GRanges object with 74 ranges and 4 metadata columns: #>              seqnames    ranges strand |         REF       rbpz #>                 <Rle> <IRanges>  <Rle> | <character>  <numeric> #>   SSR3-102--     SSR3       102      - |           T   2.611800 #>   SSR3-125--     SSR3       125      - |           C   0.623238 #>   SSR3-156--     SSR3       156      - |           C   1.875144 #>   SSR3-176--     SSR3       176      - |           A  -0.676423 #>   SSR3-198--     SSR3       198      - |           A   1.817678 #>          ...      ...       ...    ... .         ...        ... #>   DHFR-397--     DHFR       397      - |           A -2.7341600 #>   DHFR-399--     DHFR       399      - |           G -0.2094944 #>   DHFR-423--     DHFR       423      - |           T -0.0815516 #>   DHFR-430--     DHFR       430      - |           A -2.6781858 #>   DHFR-513--     DHFR       513      - |           T -1.2475213 #>                      vpb       sor #>                <numeric> <numeric> #>   SSR3-102-- 2.21621e-02  2.776147 #>   SSR3-125-- 2.21621e-02  0.478641 #>   SSR3-156-- 2.21621e-02  2.786335 #>   SSR3-176-- 2.00523e-05  2.154124 #>   SSR3-198-- 2.21621e-02  2.797103 #>          ...         ...       ... #>   DHFR-397--   0.0221621  2.775538 #>   DHFR-399--   0.0221621  0.306541 #>   DHFR-423--   0.0221621  2.773352 #>   DHFR-430--   0.0221621  2.773426 #>   DHFR-513--   0.0221621  2.772591 #>   ------- #>   seqinfo: 3 sequences from an unspecified genome  # specifying regions to query use GRanges object sites <- rowRanges(rse) rse <- pileup_sites(bams, fafn, sites = sites) rse #> class: RangedSummarizedExperiment  #> dim: 74 6  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(74): SSR3-102-- SSR3-125-- ... DHFR-430-- DHFR-513-- #> rowData names(4): REF rbpz vpb sor #> colnames(6): KO1 KO2 ... WT2 WT3 #> colData names(1): sample  rse <- pileup_sites(bams, fafn, chroms = c(\"SPCS3\", \"DHFR\")) rse #> class: RangedSummarizedExperiment  #> dim: 1166 6  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(1166): SPCS3-1-+ SPCS3-2-+ ... DHFR-517-- DHFR-518-- #> rowData names(4): REF rbpz vpb sor #> colnames(6): KO1 KO2 ... WT2 WT3 #> colData names(1): sample  rse <- pileup_sites(bams, fafn, region = \"DHFR:100-101\") rse #> class: RangedSummarizedExperiment  #> dim: 2 6  #> metadata(0): #> assays(7): ALT nRef ... nC nG #> rownames(2): DHFR-100-- DHFR-101-- #> rowData names(4): REF rbpz vpb sor #> colnames(6): KO1 KO2 ... WT2 WT3 #> colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/prep_for_de.html","id":null,"dir":"Reference","previous_headings":"","what":"Make summarized experiment object for DE â€” prep_for_de","title":"Make summarized experiment object for DE â€” prep_for_de","text":"Generates SummarizedExperiment object use edgeR DESeq2 generate counts assay matrix formated 2 columns per sample","code":""},{"path":"https://rnabioco.github.io/raer/reference/prep_for_de.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make summarized experiment object for DE â€” prep_for_de","text":"","code":"prep_for_de(   se,   type = \"AI\",   edit_from = NULL,   edit_to = NULL,   min_prop = 0.1,   max_prop = 0.9,   min_samples = 3 )"},{"path":"https://rnabioco.github.io/raer/reference/prep_for_de.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make summarized experiment object for DE â€” prep_for_de","text":"se SummarizedExperiment object type OPTIONAL type editing event add. Currently, supported (\"AI\") default, custom can added setting \"none\". edit_from OPTIONAL using pre-built type, can specify editing. nucleotide (, C, G, T) correspond nucleotide expect reference. Ex. editing events, \"\". type \"AI\", edit edit_to must set. edit_to OPTIONAL using pre-built type, can specify editing. nucleotide (, C, G, T) correspond nucleotide expect editing event. Ex. editing events, \"G\". type \"AI\", edit edit_to must set. min_prop OPTIONAL min proporation reads edited site. least min_samples need pass keep site. Default 0.1. max_prop OPTIONAL max proporation reads edited site. least min_samples need pass keep site. Default 0.9. min_samples OPTIONAL minimum number samples passing cutoffs keep site. Default 3.","code":""},{"path":"https://rnabioco.github.io/raer/reference/prep_for_de.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make summarized experiment object for DE â€” prep_for_de","text":"SummarizedExperiment::SummarizedExperiment use edgeR DESeq2. Contains counts assay matrix formatted 2 columns per sample (ref alt counts).","code":""},{"path":"https://rnabioco.github.io/raer/reference/prep_for_de.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make summarized experiment object for DE â€” prep_for_de","text":"","code":"library(SummarizedExperiment) data(rse_adar_ifn) rse <- calc_edit_frequency(rse_adar_ifn) dse <- prep_for_de(rse, min_samples = 1) assay(dse, \"counts\")[1:5, ] #>            wt_ref adar1_ko_ref wt_alt adar1_ko_alt #> SSR3_176_-      8           16     16            0 #> SSR3_201_-     19           14      3            0 #> SSR3_207_-     14           14      4            0 #> SSR3_257_-     11           19      4            0 #> SSR3_258_-      9           10      6            8 dse #> class: SummarizedExperiment  #> dim: 27 4  #> metadata(0): #> assays(1): counts #> rownames(27): SSR3_176_- SSR3_201_- ... DHFR_355_- DHFR_361_- #> rowData names(0): #> colnames(4): wt_ref adar1_ko_ref wt_alt adar1_ko_alt #> colData names(4): sample n_sites edit_idx count"},{"path":"https://rnabioco.github.io/raer/reference/raer.html","id":null,"dir":"Reference","previous_headings":"","what":"raer: RNA editing tools in R â€” raer","title":"raer: RNA editing tools in R â€” raer","text":"Toolkit identification statistical testing RNA editing signals within R. Provides support identifying sites bulk-RNA single cell RNA-seq datasets, general methods extraction allelic read counts alignment files. Facilitates annotation exploratory analysis editing signals using Bioconductor packages resources.","code":""},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/raer.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"raer: RNA editing tools in R â€” raer","text":"Maintainer: Kent Riemondy kent.riemondy@gmail.com (ORCID) Authors: Kristen Wells-Wrasman kristen.wells-wrasman@cuanschutz.edu (ORCID) contributors: Ryan Sheridan ryan.sheridan@cuanschutz.edu (ORCID) [contributor] Jay Hesselberth jay.hesselberth@gmail.com (ORCID) [contributor] RNA Bioscience Initiative [copyright holder, funder]","code":""},{"path":"https://rnabioco.github.io/raer/reference/raer_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Provide working directory for raer example files. â€” raer_example","title":"Provide working directory for raer example files. â€” raer_example","text":"Provide working directory raer example files.","code":""},{"path":"https://rnabioco.github.io/raer/reference/raer_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provide working directory for raer example files. â€” raer_example","text":"","code":"raer_example(path)"},{"path":"https://rnabioco.github.io/raer/reference/raer_example.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provide working directory for raer example files. â€” raer_example","text":"path path file","code":""},{"path":"https://rnabioco.github.io/raer/reference/raer_example.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provide working directory for raer example files. â€” raer_example","text":"Character vector path internal package file.","code":""},{"path":"https://rnabioco.github.io/raer/reference/raer_example.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Provide working directory for raer example files. â€” raer_example","text":"","code":"raer_example(\"human.fasta\") #> [1] \"/__w/_temp/Library/raer/extdata/human.fasta\""},{"path":"https://rnabioco.github.io/raer/reference/read_pileup.html","id":null,"dir":"Reference","previous_headings":"","what":"Read pileup, indexed by tabix â€” read_pileup","title":"Read pileup, indexed by tabix â€” read_pileup","text":"function can read pileup site data tables produced pileup_sites().","code":""},{"path":"https://rnabioco.github.io/raer/reference/read_pileup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read pileup, indexed by tabix â€” read_pileup","text":"","code":"read_pileup(tbx_fn, region = NULL)"},{"path":"https://rnabioco.github.io/raer/reference/read_pileup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read pileup, indexed by tabix â€” read_pileup","text":"tbx_fn filename region region read file, samtools style region specifiers supported.","code":""},{"path":"https://rnabioco.github.io/raer/reference/read_pileup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read pileup, indexed by tabix â€” read_pileup","text":"GenomicRanges::GRanges containing positions editing sites pileup data.","code":""},{"path":"https://rnabioco.github.io/raer/reference/read_pileup.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read pileup, indexed by tabix â€” read_pileup","text":"","code":"bamfn <- system.file(\"extdata\", \"SRR5564269_Aligned.sortedByCoord.out.md.bam\", package = \"raer\") fafn <- system.file(\"extdata\", \"human.fasta\", package = \"raer\") plp_fn <- tempfile() plp <- pileup_sites(bamfn, fafn, return_data = FALSE, outfile_prefix = plp_fn)  # first table contains site information, second table pileup count lapply(plp, function(x) head(read_pileup(x))) #> Warning: number of items to replace is not a multiple of replacement length #> [[1]] #> GRanges object with 6 ranges and 4 metadata columns: #>       seqnames    ranges strand |         REF       ALT      nRef #>          <Rle> <IRanges>  <Rle> | <character> <numeric> <numeric> #>   [1]     SSR3         1      - |           C         0         0 #>   [2]     SSR3         2      - |           A         0         0 #>   [3]     SSR3         3      - |           A         0         0 #>   [4]     SSR3         4      - |           A         0         0 #>   [5]     SSR3         5      - |           G         0         0 #>   [6]     SSR3         6      - |           T         0         0 #>            nAlt #>       <numeric> #>   [1]         0 #>   [2]         0 #>   [3]         0 #>   [4]         0 #>   [5]         0 #>   [6]         0 #>   ------- #>   seqinfo: 3 sequences from an unspecified genome; no seqlengths #>  #> [[2]] #> GRanges object with 6 ranges and 10 metadata columns: #>       seqnames    ranges strand |         REF         ALT      nRef #>          <Rle> <IRanges>  <Rle> | <character> <character> <integer> #>   [1]     SSR3         1      - |           C           -        13 #>   [2]     SSR3         2      - |           A           -        14 #>   [3]     SSR3         3      - |           A           -        14 #>   [4]     SSR3         4      - |           A           -        15 #>   [5]     SSR3         5      - |           G           -        15 #>   [6]     SSR3         6      - |           T           -        15 #>            nAlt        nA        nT        nC        nG        nN #>       <integer> <integer> <integer> <integer> <integer> <integer> #>   [1]         0         0         0        13         0         0 #>   [2]         0        14         0         0         0         0 #>   [3]         0        14         0         0         0         0 #>   [4]         0        15         0         0         0         0 #>   [5]         0         0         0         0        15         0 #>   [6]         0         0        15         0         0         0 #>              nX #>       <integer> #>   [1]         2 #>   [2]         1 #>   [3]         1 #>   [4]         0 #>   [5]         0 #>   [6]         0 #>   ------- #>   seqinfo: 3 sequences from an unspecified genome; no seqlengths #>  unlink(c(plp, plp_fn, paste0(plp, \".tbi\")))"},{"path":"https://rnabioco.github.io/raer/reference/read_sparray.html","id":null,"dir":"Reference","previous_headings":"","what":"Read tables produced by pileup_cells() â€” read_sparray","title":"Read tables produced by pileup_cells() â€” read_sparray","text":"Read tables produced pileup_cells(), extension matrixMarket sparse matrix format store values 1 matrix. .mtx.gz files formatted columns: row index (0 based) column index (0 based) values sparseMatrix #1 (nRef) values sparseMatrix #2 (nAlt) N) values sparseMatrix ... (...) ununsed now","code":""},{"path":"https://rnabioco.github.io/raer/reference/read_sparray.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read tables produced by pileup_cells() â€” read_sparray","text":"","code":"read_sparray(mtx_fn, sites_fn, bc_fn)"},{"path":"https://rnabioco.github.io/raer/reference/read_sparray.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read tables produced by pileup_cells() â€” read_sparray","text":"mtx_fn .mtx.gz file path sites_fn sites.txt.gz file path bc_fn bcs.txt.gz file path","code":""},{"path":"https://rnabioco.github.io/raer/reference/read_sparray.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read tables produced by pileup_cells() â€” read_sparray","text":"list sparseMatrix, NULL mtx_fn empty","code":""},{"path":"https://rnabioco.github.io/raer/reference/rse_adar_ifn.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample data for RNA editing analysis â€” rse_adar_ifn","title":"Sample data for RNA editing analysis â€” rse_adar_ifn","text":"subset data RNA-seq experiment measure effects IFN treatment cell lines wild-type ADAR1-KO","code":""},{"path":"https://rnabioco.github.io/raer/reference/rse_adar_ifn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample data for RNA editing analysis â€” rse_adar_ifn","text":"","code":"data(rse_adar_ifn)"},{"path":[]},{"path":"https://rnabioco.github.io/raer/reference/rse_adar_ifn.html","id":"rse-adar-ifn","dir":"Reference","previous_headings":"","what":"rse_adar_ifn","title":"Sample data for RNA editing analysis â€” rse_adar_ifn","text":"","code":"class: RangedSummarizedExperiment dim: 74 2 metadata(0): assays(7): Var nRef ... nC nG rownames(74): SSR3_102_- SSR3_125_- ... DHFR_430_- DHFR_513_- rowData names(1): Ref colnames(2): wt adar1_ko colData names(1): sample"},{"path":"https://rnabioco.github.io/raer/reference/rse_adar_ifn.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Sample data for RNA editing analysis â€” rse_adar_ifn","text":"https://www.ncbi.nlm.nih.gov/bioproject/PRJNA386593","code":""},{"path":"https://rnabioco.github.io/raer/reference/rse_adar_ifn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample data for RNA editing analysis â€” rse_adar_ifn","text":"RangedSummarizedExperiment populated pileup data","code":""},{"path":"https://rnabioco.github.io/raer/reference/rse_adar_ifn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sample data for RNA editing analysis â€” rse_adar_ifn","text":"https://pubmed.ncbi.nlm.nih.gov/29395325/","code":""},{"path":"https://rnabioco.github.io/raer/news/index.html","id":"raer-0990","dir":"Changelog","previous_headings":"","what":"raer 0.99.0","title":"raer 0.99.0","text":"add option query ref alt SNP alleles added tests SummarizedExperiment filtering approaches added strand bias stat sor using approach GATK (StrandOddsRatio), confidence score calc_confidence() SAILOR pipeline. â€˜Nâ€™ bases read reference ignored Removed outdated unused functionality: bed indexing (indexBed related C code) bam tag indexing (build_tag_index, show_tag_index, get_tag_bam, ) bam tag index based single cell approach (sc_editing) bam tag indexing C code bri (src/bri/*) sparse matrix merging merge_pileups(). unneeded utilities (filter_by_coverage) Remaining (mostly unused) Rcpp code Removed fastmap, Rcpp, zlibbioc, RColorBrewer, BiocGenerics dependencies Removed system requirements C libraries used bri bed indexing used pileup_sites() replaced region indexing approach pileup_cells(). pileup_sites() now requires GRanges object rather bed file. bedfileparameter removed replaced sites parameter. Renamed Ref Var output columns REF ALT nVar renamed nAlt. provides consistency VCF format consistency across pileup_cells() pileup_sites() function calls pileup_cells() gained functionality process multiple smart-seq2 style bam files. Changed filterParam argument pileup_sites pileup_cells param simplicity. Added FilterParam exclude multi-allelic sites report_multiallelic, exclude reporting variant Var assay based allelic frequency (min_allelic_freq). bam_flags parameter used pileup_sites pileup_cells moved FilterParam class. bedindex parameter pileup_sites removed. option needed user level planned replaced regional indexing used pileup_cells(). Added FilterParam option trim reads based fractional distance 5â€™ (ftrim_5p) 3â€™ end (ftrim_3p). Incorporated RBPZ VDB statistics bcftools, now returned rowData columns calling pileup_sites. RangedSummarizedExperiment object now directly returned pileup_sites. Using merge_pileups longer necessary exported function. Renamed get_pileup pileup_sites create_se merge_pileups Rename remove_clustered_variants, remove_multiallelic, remove_splice_variants filter_* consistency. Rewrote renamed single cell editing function sc_editing pileup_cells(). pileup_cells() require sorting index cell barcode, uses new format specify sites query requires providing reference alternate alleles interest, writes disk sparse matrix compatible format reduce memory usage, performance need query fasta index. Implemented method collapse reads duplicate UMIs. Added option filter sites pileup based number reads containing variant (#54) Added NEWS.md file track changes package.","code":""}]
